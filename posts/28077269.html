<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><title>ROS-TFä¸URDF | Malloy Yuan çš„ä¸ªäººåšå®¢</title><meta name="keywords" content="ROS,Linux"><meta name="author" content="Malloy Yuan"><meta name="copyright" content="Malloy Yuan"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="æœºå™¨äººæ“ä½œç³»ç»Ÿ"><meta property="og:type" content="article"><meta property="og:title" content="ROS-TFä¸URDF"><meta property="og:url" content="https://elec-creator.com/posts/28077269.html"><meta property="og:site_name" content="Malloy Yuan çš„ä¸ªäººåšå®¢"><meta property="og:description" content="æœºå™¨äººæ“ä½œç³»ç»Ÿ"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/MCUheart/Hexo-blog-data@1.0.2/image/cover/post-cover/ros-cover.jpg"><meta property="article:published_time" content="2020-04-27T08:26:40.000Z"><meta property="article:modified_time" content="2022-02-10T03:46:06.118Z"><meta property="article:author" content="Malloy Yuan"><meta property="article:tag" content="ROS"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/MCUheart/Hexo-blog-data@1.0.2/image/cover/post-cover/ros-cover.jpg"><link rel="shortcut icon" href="/img/private/favicon.ico"><link rel="canonical" href="https://elec-creator.com/posts/28077269"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""><link rel="preconnect" href="//hm.baidu.com"><link rel="preconnect" href="//fonts.googleapis.com" crossorigin=""><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="manifest" href="/img/private/pwa/manifest.json"><meta name="msapplication-TileColor" content="#000000"><link rel="apple-touch-icon" sizes="180x180" href="/img/private/pwa/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/img/private/pwa/32.png"><link rel="icon" type="image/png" sizes="16x16" href="/img/private/pwa/16.png"><link rel="mask-icon" href="/img/private/pwa/safari-pinned-tab.svg" color="#5bbad5"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload='this.media="all"'><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(adsbygoogle=window.adsbygoogle||[]).push({google_ad_client:"ca-pub-6017375467561303",enable_page_level_ads:"true"})</script><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?f0eee211545bfd4d4a152fd36de6c1a1";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-161823084-1"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-161823084-1")</script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web" media="print" onload='this.media="all"'><script>const GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:{path:"search.xml",languages:{hits_empty:"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}"}},translate:{defaultEncoding:2,translateDelay:0,msgToTraditionalChinese:"ç¹",msgToSimplifiedChinese:"ç®€"},noticeOutdate:void 0,highlight:{plugin:"highlighjs",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:200},copy:{success:"å¤åˆ¶æˆåŠŸ",error:"å¤åˆ¶é”™è¯¯",noSupport:"æµè§ˆå™¨ä¸æ”¯æŒ"},relativeDate:{homepage:!1,post:!1},runtime:"å¤©",date_suffix:{just:"åˆšåˆš",min:"åˆ†é’Ÿå‰",hour:"å°æ—¶å‰",day:"å¤©å‰",month:"ä¸ªæœˆå‰"},copyright:void 0,lightbox:"fancybox",Snackbar:void 0,source:{justifiedGallery:{js:"https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js",css:"https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css"}},isPhotoFigcaption:!1,islazyload:!0,isAnchor:!0}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"ROS-TFä¸URDF",isPost:!0,isHome:!1,isHighlightShrink:!0,isToc:!0,postUpdate:"2022-02-10 11:46:06"}</script><noscript><style>#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(e=>{e.saveToLocal={set:function(e,t,o){if(0===o)return;const n=864e5*o,a={value:t,expiry:(new Date).getTime()+n};localStorage.setItem(e,JSON.stringify(a))},get:function(e){const t=localStorage.getItem(e);if(!t)return;const o=JSON.parse(t);if(!((new Date).getTime()>o.expiry))return o.value;localStorage.removeItem(e)}},e.getScript=e=>new Promise((t,o)=>{const n=document.createElement("script");n.src=e,n.async=!0,n.onerror=o,n.onload=n.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,t())},document.head.appendChild(n)}),e.activateDarkMode=function(){document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},e.activateLightMode=function(){document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#ffffff")};const t=saveToLocal.get("theme");"dark"===t?activateDarkMode():"light"===t&&activateLightMode();const o=saveToLocal.get("aside-status");void 0!==o&&("hide"===o?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})(window)</script><link rel="stylesheet" href="//at.alicdn.com/t/font_1975360_mudsyg8elc9.css"><style>.app-refresh{position:fixed;top:-2.2rem;left:0;right:0;z-index:99999;padding:0 1rem;font-size:15px;height:2.2rem;transition:all .3s ease}.app-refresh-wrap{display:flex;color:#fff;height:100%;align-items:center;justify-content:center}.app-refresh-wrap a{color:#fff;text-decoration:underline;cursor:pointer}</style><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="Malloy Yuan çš„ä¸ªäººåšå®¢" type="application/atom+xml"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/private/loading-4.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/MCUheart/Hexo-blog-data@1.0.2/image/portrait/portrait-3.jpg" onerror='onerror=null,src="/img/private/site_img-load-404-1.gif"' alt="avatar"></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">54</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">34</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">37</div></a></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>ä¸»é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>æ—¶é—´è½´</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-list"></i> <span>å¨±ä¹</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i> <span>éŸ³ä¹</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-film"></i> <span>ç”µå½±</span></a></li><li><a class="site-page child" href="/gallery/"><i class="fa-fw fas fa-camera-retro"></i> <span>ç…§ç‰‡</span></a></li><li><a class="site-page child" href="/books/"><i class="fa-fw fas fa-book"></i> <span>é˜…è¯»</span></a></li><li><a class="site-page child" href="/games/"><i class="fa-fw fas fa-gamepad"></i> <span>æ¸¸æˆ</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/messageaboard/"><i class="fa-fw fas fa-comment-dots"></i> <span>ç•™è¨€æ¿</span></a></div><div class="menus_item"><a class="site-page" href="/artitalk/"><i class="fa-fw fas fa-cat"></i> <span>è¯´è¯´</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i> <span>å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-address-book"></i> <span>å…³äº</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url(https://cdn.jsdelivr.net/gh/MCUheart/Hexo-blog-data@1.0.2/image/top/post-top/ros-top.jpg)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Malloy Yuan çš„ä¸ªäººåšå®¢</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i> <span>æœç´¢</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>ä¸»é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i> <span>æ—¶é—´è½´</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i> <span>æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i> <span>åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-list"></i> <span>å¨±ä¹</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i> <span>éŸ³ä¹</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-film"></i> <span>ç”µå½±</span></a></li><li><a class="site-page child" href="/gallery/"><i class="fa-fw fas fa-camera-retro"></i> <span>ç…§ç‰‡</span></a></li><li><a class="site-page child" href="/books/"><i class="fa-fw fas fa-book"></i> <span>é˜…è¯»</span></a></li><li><a class="site-page child" href="/games/"><i class="fa-fw fas fa-gamepad"></i> <span>æ¸¸æˆ</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/messageaboard/"><i class="fa-fw fas fa-comment-dots"></i> <span>ç•™è¨€æ¿</span></a></div><div class="menus_item"><a class="site-page" href="/artitalk/"><i class="fa-fw fas fa-cat"></i> <span>è¯´è¯´</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i> <span>å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-address-book"></i> <span>å…³äº</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">ROS-TFä¸URDF</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2020-04-27T08:26:40.000Z" title="å‘è¡¨äº 2020-04-27 16:26:40">2020-04-27</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2022-02-10T03:46:06.118Z" title="æ›´æ–°äº 2022-02-10 11:46:06">2022-02-10</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/ros/">ROS</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">å­—æ•°æ€»è®¡:</span><span class="word-count">9.4k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»æ—¶é•¿:</span><span>39åˆ†é’Ÿ</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title="ROS-TFä¸URDF"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">è¯„è®ºæ•°:</span><a href="/posts/28077269.html#post-comment"><span id="twikoo-count"></span></a></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><link rel="stylesheet external nofollow noreferrer" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><div class="note primary flat"><p>ğŸ“– æœºå™¨äººçš„åæ ‡å˜æ¢ä¸€ç›´ä»¥æ¥æ˜¯æœºå™¨äººå­¦çš„ä¸€ä¸ªéš¾ç‚¹ï¼Œæˆ‘ä»¬äººç±»åœ¨è¿›è¡Œä¸€ä¸ªç®€å•çš„åŠ¨ä½œæ—¶ï¼Œä»æ€è€ƒåˆ°å®æ–½è¡ŒåŠ¨å†åˆ°å®ŒæˆåŠ¨ä½œå¯èƒ½ä»…ä»…éœ€è¦å‡ ç§’é’Ÿï¼Œä½†æ˜¯æœºå™¨äººæ¥è®²å°±éœ€è¦å¤§é‡çš„è®¡ç®—å’Œåæ ‡è½¬æ¢ã€‚</p></div><hr><h1 id="1-è®¤è¯†tf"><a class="markdownIt-Anchor" href="#1-è®¤è¯†tf"></a> 1. è®¤è¯†TF</h1><h2 id="11-ç®€ä»‹"><a class="markdownIt-Anchor" href="#11-ç®€ä»‹"></a> 1.1. ç®€ä»‹</h2><p>TFæ˜¯ä¸€ä¸ªROSä¸–ç•Œé‡Œçš„ä¸€ä¸ªåŸºæœ¬çš„ä¹Ÿæ˜¯å¾ˆé‡è¦çš„æ¦‚å¿µï¼Œæ‰€è°“TF(TransForm)ï¼Œå°±æ˜¯åæ ‡è½¬æ¢ï¼åœ¨ç°å®ç”Ÿæ´»ä¸­ï¼Œæˆ‘ä»¬åšå‡ºå„ç§è¡Œä¸ºæ¨¡å¼éƒ½å¯ä»¥åœ¨å¾ˆçŸ­çš„æ—¶é—´é‡Œå®Œæˆï¼Œæ¯”å¦‚æ‹¿èµ·èº«è¾¹çš„ç‰©å“ï¼Œä½†æ˜¯åœ¨æœºå™¨äººçš„ä¸–ç•Œé‡Œï¼Œåˆ™è¿œè¿œæ²¡æœ‰é‚£ä¹ˆç®€å•ï¼è§‚å¯Ÿä¸‹å›¾ï¼Œæˆ‘ä»¬æ¥åˆ†ææœºå™¨äººæ‹¿èµ·èº«è¾¹çš„ç‰©å“éœ€è¦åšåˆ°ä»€ä¹ˆï¼Œè€ŒTFåˆèµ·åˆ°ä»€ä¹ˆæ ·çš„ä½œç”¨ï¼</p><p><img src="/img/private/loading-4.gif" data-lazy-src="https://sychaichangkun.gitbooks.io/ros-tutorial-icourse163/content/pics/pr2_tf.png" alt="img"></p><p>è§‚å¯Ÿè¿™ä¸ªæœºå™¨äººï¼Œæˆ‘ä»¬ç›´è§‚ä¸Šä¸è®¤ä¸ºæ‹¿èµ·ç‰©å“ä¼šåˆä»€ä¹ˆéš¾åº¦ï¼Œç«™åœ¨äººç±»çš„ç«‹åœºä¸Šï¼Œæˆ‘ä»¬ä¹Ÿè®¸ä¼šæƒ³åˆ°æ‰‹å‘å‰ä¼¸ï¼ŒæŠ“ä½ï¼Œæ‰‹æ”¶å›ï¼å°±å®Œæˆäº†è¿™æ•´ä¸ªä¸€ç³»åˆ—çš„åŠ¨ä½œï¼ä½†æ˜¯å¦‚ä»Šçš„æœºå™¨äººè¿œè¿œæ²¡æœ‰è¿™ä¹ˆæ™ºèƒ½ï¼Œå®ƒèƒ½å¾—åˆ°çš„åªæ˜¯å„ç§ä¼ æ„Ÿå™¨å‘é€å›æ¥çš„æ•°æ®ï¼Œç„¶åå®ƒå†å¤„ç†å„ç§æ•°æ®è¿›è¡Œæ“ä½œï¼Œæ¯”å¦‚æ‰‹è‡‚å¼¯æ›²45åº¦ï¼Œå†å‘å‰ç§»åŠ¨ï¼’ï¼cmç­‰è¿™æ ·çš„å„ç§ååˆ†ç²¾ç¡®çš„æ•°æ®ï¼Œå°½ç®¡å¦‚æ­¤ï¼Œæœºå™¨äººä¾ç„¶æ²¡æ³•åšåˆ°åƒäººç±»ä¸€æ ·è‡ªå¦‚çš„è¿›è¡Œå„ç§è¡Œä¸ºæ“ä½œï¼é‚£ä¹ˆåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼ŒTFåˆæ‰®æ¼”ç€ä»€ä¹ˆæ ·çš„è§’è‰²å‘¢ï¼Ÿè¿˜æ‹¿è¯¥å›¾æ¥è¯´ï¼Œå½“æœºå™¨äººçš„ï¼‚çœ¼ç›ï¼‚è·å–ä¸€ç»„æ•°æ®ï¼Œå…³äºç‰©ä½“çš„åæ ‡æ–¹ä½ï¼Œä½†æ˜¯ç›¸å¯¹äºæœºå™¨äººæ‰‹è‡‚æ¥è¯´ï¼Œ<strong>è¿™ä¸ªåæ ‡åªæ˜¯ç›¸å¯¹äºæœºå™¨äººå¤´éƒ¨çš„ä¼ æ„Ÿå™¨ï¼Œå¹¶ä¸ç›´æ¥é€‚ç”¨äºæœºå™¨äººæ‰‹è‡‚æ‰§è¡Œï¼Œé‚£ä¹ˆç‰©ä½“ç›¸å¯¹äºå¤´éƒ¨å’Œæ‰‹è‡‚ä¹‹é—´çš„åæ ‡è½¬æ¢ï¼Œå°±æ˜¯TF.</strong></p><p>åæ ‡å˜æ¢åŒ…æ‹¬äº†ä½ç½®å’Œå§¿æ€ä¸¤ä¸ªæ–¹é¢çš„å˜æ¢ï¼ŒROSä¸­çš„tfæ˜¯ä¸€ä¸ªå¯ä»¥è®©ç”¨æˆ·éšæ—¶è®°å½•å¤šä¸ªåæ ‡ç³»çš„è½¯ä»¶åŒ…ã€‚tfä¿æŒç¼“å­˜çš„æ ‘å½¢ç»“æ„ä¸­çš„åæ ‡ç³»ä¹‹é—´çš„å…³ç³»ï¼Œå¹¶ä¸”å…è®¸ç”¨æˆ·åœ¨ä»»ä½•æœŸæœ›çš„æ—¶é—´ç‚¹åœ¨ä»»ä½•ä¸¤ä¸ªåæ ‡ç³»ä¹‹é—´è½¬æ¢ç‚¹ï¼ŒçŸ¢é‡ç­‰ï¼</p><h2 id="12-rosä¸­çš„tf"><a class="markdownIt-Anchor" href="#12-rosä¸­çš„tf"></a> 1.2. ROSä¸­çš„TF</h2><p>tfçš„å®šä¹‰ä¸æ˜¯é‚£ä¹ˆçš„æ­»æ¿ï¼Œå®ƒå¯ä»¥è¢«å½“åšæ˜¯ä¸€ç§æ ‡å‡†è§„èŒƒï¼Œè¿™å¥—æ ‡å‡†å®šä¹‰äº†åæ ‡è½¬æ¢çš„æ•°æ®æ ¼å¼å’Œæ•°æ®ç»“æ„ï¼tfæœ¬è´¨æ˜¯æ ‘çŠ¶çš„æ•°æ®ç»“æ„ï¼Œæ‰€ä»¥æˆ‘ä»¬é€šå¸¸ç§°ä¹‹ä¸º**â€œtf treeâ€**,tfä¹Ÿå¯ä»¥çœ‹æˆæ˜¯ä¸€ä¸ªtopic:<code>/tf</code>ï¼Œè¯é¢˜ä¸­çš„messageä¿å­˜çš„å°±æ˜¯tf treeçš„æ•°æ®ç»“æ„æ ¼å¼ï¼ç»´æŠ¤äº†æ•´ä¸ªæœºå™¨äººçš„ç”šè‡³æ˜¯åœ°å›¾çš„åæ ‡è½¬æ¢å…³ç³»ï¼tfè¿˜å¯ä»¥çœ‹æˆæ˜¯ä¸€ä¸ªpackage,å®ƒå½“ä¸­åŒ…å«äº†å¾ˆå¤šçš„å·¥å…·ï¼æ¯”å¦‚å¯è§†åŒ–ï¼ŒæŸ¥çœ‹å…³èŠ‚é—´çš„tf,debug tfç­‰ç­‰ï¼tfå«æœ‰ä¸€éƒ¨åˆ†çš„æ¥å£ï¼Œå°±æ˜¯æˆ‘ä»¬å‰é¢ç« èŠ‚ä»‹ç»çš„roscppå’Œrospyé‡Œå…³äºtfçš„APIï¼æ‰€ä»¥å¯ä»¥çœ‹æˆæ˜¯è¯é¢˜è½¬æ¢çš„æ ‡å‡†ï¼Œå·¥å…·ï¼Œæ¥å£ï¼</p><p><img src="/img/private/loading-4.gif" data-lazy-src="https://sychaichangkun.gitbooks.io/ros-tutorial-icourse163/content/pics/tf_wiki.png" alt="img"></p><p>è§‚å¯Ÿä¸Šå›¾ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ROSæ•°æ®ç»“æ„çš„ä¸€ä¸ªæŠ½è±¡å›¾ï¼ŒROSä¸­æœºå™¨äººæ¨¡å‹åŒ…å«å¤§é‡çš„éƒ¨ä»¶ï¼Œè¿™äº›éƒ¨ä»¶ç»Ÿç§°ä¹‹ä¸º<strong>link</strong>,æ¯ä¸€ä¸ªlinkä¸Šé¢å¯¹åº”ç€ä¸€ä¸ª<strong>frame</strong>, å³ä¸€ä¸ªåæ ‡ç³»ï¼<strong>linkå’Œframeæ¦‚å¿µæ˜¯ç»‘å®šåœ¨ä¸€èµ·çš„</strong>ï¼åƒä¸Šå›¾pr2æ¨¡å‹ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åˆå¾ˆå¤šçš„frame,é”™ç»¼å¤æ‚çš„é“ºç½®åœ¨æœºå™¨äººçš„å„ä¸ªlinkä¸Šï¼Œç»´æŠ¤å„ä¸ªåæ ‡ç³»ä¹‹é—´çš„å…³ç³»ï¼Œå°±è¦é ç€<strong>tf tree</strong>æ¥å¤„ç†ï¼Œç»´æŠ¤ç€å„ä¸ªåæ ‡ç³»ä¹‹é—´çš„è”é€šï¼å¦‚ä¸‹å›¾ï¼š</p><p><img src="/img/private/loading-4.gif" data-lazy-src="https://sychaichangkun.gitbooks.io/ros-tutorial-icourse163/content/pics/tf_tree_pr2.png" alt="img"></p><p>ä¸Šå›¾æ˜¯æˆ‘ä»¬å¸¸ç”¨çš„robot_sim_demoè¿è¡Œèµ·æ¥çš„tfã€€treeç»“æ„ï¼Œæ¯ä¸€ä¸ªåœ†åœˆä»£è¡¨ä¸€ä¸ªframe,å¯¹åº”ç€æœºå™¨äººä¸Šçš„ä¸€ä¸ªlinkï¼Œ<strong>ä»»æ„çš„ä¸¤ä¸ªframeä¹‹é—´éƒ½å¿…é¡»æ˜¯è”é€šçš„</strong>ï¼Œå¦‚æœå‡ºç°æŸä¸€ç¯èŠ‚çš„æ–­è£‚ï¼Œ<strong>å°±ä¼šå¼•å‘errorç³»ç»ŸæŠ¥é”™</strong>ï¼<strong>æ‰€ä»¥å®Œæ•´çš„tf treeä¸èƒ½æœ‰ä»»ä½•æ–­å±‚çš„åœ°æ–¹</strong>ï¼Œè¿™æ ·æˆ‘ä»¬æ‰èƒ½æŸ¥æ¸…æ¥šä»»æ„ä¸¤ä¸ªframeä¹‹é—´çš„å…³ç³»ï¼ä»”ç»†è§‚å¯Ÿä¸Šå›¾ï¼Œæˆ‘ä»¬å‘ç°æ¯ä¸¤ä¸ªframeä¹‹é—´éƒ½æœ‰ä¸€ä¸ª<strong>broadcaster</strong>,è¿™å°±æ˜¯ä¸ºäº†ä½¿å¾—ä¸¤ä¸ªframeä¹‹é—´èƒ½å¤Ÿæ­£ç¡®è¿é€šï¼Œä¸­é—´éƒ½ä¼šæœ‰ä¸€ä¸ªNodeæ¥å‘å¸ƒæ¶ˆæ¯æ¥broadcaster.å¦‚æœç¼ºå°‘Nodeæ¥å‘å¸ƒæ¶ˆæ¯ç»´æŠ¤è¿é€šï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªframeä¹‹é—´çš„è¿æ¥å°±ä¼šæ–­æ‰ï¼<strong>broadcasterå°±æ˜¯ä¸€ä¸ªpublisher,å¦‚æœä¸¤ä¸ªframeä¹‹é—´å‘ç”Ÿäº†ç›¸å¯¹è¿åŠ¨</strong>ï¼Œbroadcasterå°±ä¼šå‘å¸ƒç›¸å…³æ¶ˆæ¯ï¼</p><h1 id="2-tfæ¶ˆæ¯"><a class="markdownIt-Anchor" href="#2-tfæ¶ˆæ¯"></a> 2. TFæ¶ˆæ¯</h1><h2 id="21-transformstampedmsg"><a class="markdownIt-Anchor" href="#21-transformstampedmsg"></a> 2.1. TransformStamped.msg</h2><p><img src="/img/private/loading-4.gif" data-lazy-src="https://sychaichangkun.gitbooks.io/ros-tutorial-icourse163/content/pics/tf_tree_pr2.png" alt="img"></p><p>ä¸Šä¸€èŠ‚åœ¨ä»‹ç»ROSä¸­çš„TFæ—¶å€™æˆ‘ä»¬å·²ç»åˆæ­¥çš„è®¤è¯†äº†TFå’ŒTFæ ‘ï¼Œ<strong>äº†è§£äº†åœ¨æ¯ä¸ªframeä¹‹é—´éƒ½ä¼šæœ‰broadcasteræ¥å‘å¸ƒæ¶ˆæ¯ç»´ç³»åæ ‡è½¬æ¢</strong>ï¼é‚£ä¹ˆè¿™ä¸ªæ¶ˆæ¯åˆ°åº•æ˜¯ä»€ä¹ˆæ ·å­çš„å‘¢ï¼Ÿè¿™ä¸ªæ¶ˆæ¯TransformStampde.msg,å®ƒå°±æ˜¯å¤„ç†ä¸¤ä¸ªframeä¹‹é—´ä¸€å°æ®µtfçš„æ•°æ®æ ¼å¼ï¼</p><h2 id="22-æ ¼å¼è§„èŒƒ"><a class="markdownIt-Anchor" href="#22-æ ¼å¼è§„èŒƒ"></a> 2.2. æ ¼å¼è§„èŒƒ</h2><p>TransformStamped.msgçš„æ ¼å¼è§„èŒƒå¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">std_mags/Header header</span><br><span class="line">        uint32 seq</span><br><span class="line">        time stamp</span><br><span class="line">        string frame_id</span><br><span class="line">string child_frame_id</span><br><span class="line">geometry_msgs/Transform transform</span><br><span class="line">        geometry_msgs/Vector3 translation</span><br><span class="line">                float64 x</span><br><span class="line">                float64 y</span><br><span class="line">                float64 z</span><br><span class="line">        geometry_msgs/Quaternion rotation</span><br><span class="line">                float64 x</span><br><span class="line">                float64 y</span><br><span class="line">                flaot64 z</span><br><span class="line">                float64 w</span><br></pre></td></tr></table></figure><p>è§‚å¯Ÿæ ‡å‡†çš„æ ¼å¼è§„èŒƒï¼Œé¦–å…ˆheaderå®šä¹‰äº†åºå·ï¼Œæ—¶é—´ä»¥åŠframeçš„åç§°ï¼æ¥ç€è¿˜å†™äº†child_frameï¼Œè¿™ä¸¤ä¸ªframeä¹‹é—´è¦åšé‚£ç§å˜æ¢å°±æ˜¯ç”±geometry_msgs/Transformæ¥å®šä¹‰ï¼Vector3ä¸‰ç»´å‘é‡è¡¨ç¤ºå¹³ç§»ï¼ŒQuaternionå››å…ƒæ•°è¡¨ç¤ºæ—‹è½¬ï¼åƒä¸‹å›¾TFæ ‘ä¸­çš„ä¸¤ä¸ªframeä¹‹é—´çš„æ¶ˆæ¯ï¼Œå°±æ˜¯ç”±è¿™ç§æ ¼å¼æ¥å®šä¹‰çš„ï¼odomå°±æ˜¯frame_id,baselink_footprintå°±æ˜¯child_frame_id.æˆ‘ä»¬çŸ¥é“ï¼Œä¸€ä¸ªtopicä¸Šé¢å¯èƒ½ä¼šæœ‰å¾ˆå¤šä¸ªnodeå‘ä¸Šé¢å‘é€æ¶ˆæ¯ã€‚å¦‚å›¾æ‰€ç¤ºï¼Œä¸ä»…æœ‰æˆ‘ä»¬çœ‹åˆ°çš„frameå‘é€åæ ‡å˜æ¢ä¸ªtfï¼Œè¿˜æœ‰åˆ«çš„frameä¹Ÿåœ¨åŒæ ·çš„å‘å®ƒå‘é€æ¶ˆæ¯ã€‚æœ€ç»ˆï¼Œè®¸å¤šçš„TransformStamped.msgå‘å‘tfï¼Œå½¢æˆäº†TFæ ‘ã€‚</p><p><img src="/img/private/loading-4.gif" data-lazy-src="https://sychaichangkun.gitbooks.io/ros-tutorial-icourse163/content/pics/tf_tree.jpg" alt="img"></p><h2 id="23-tfæ ‘çš„æ•°æ®ç±»å‹"><a class="markdownIt-Anchor" href="#23-tfæ ‘çš„æ•°æ®ç±»å‹"></a> 2.3. TFæ ‘çš„æ•°æ®ç±»å‹</h2><p>ä¸Šé¢æˆ‘ä»¬è®²äº†ï¼ŒTF treeæ˜¯ç”±å¾ˆå¤šçš„frameä¹‹é—´TFæ‹¼æ¥è€Œæˆã€‚é‚£ä¹ˆTF treeæ˜¯ä»€ä¹ˆç±»å‹å‘¢ï¼Ÿå¦‚ä¸‹ï¼š</p><ul><li>tf/tfMessage.msg</li><li>tf2_msgs/TFMessage.msg</li></ul><p>è¿™é‡ŒTFçš„æ•°æ®ç±»å‹æœ‰ä¸¤ä¸ªï¼Œä¸»è¦çš„åŸå› æ˜¯ç‰ˆæœ¬çš„è¿­ä»£ã€‚è‡ªROS Hydroä»¥æ¥ï¼Œtfç¬¬ä¸€ä»£å·²è¢«â€œå¼ƒç”¨â€ï¼Œè½¬è€Œæ”¯æŒtf2ã€‚tf2ç›¸æ¯”tfæ›´åŠ ç®€å•é«˜æ•ˆã€‚æ­¤å¤–ä¹Ÿæ·»åŠ äº†ä¸€äº›æ–°çš„åŠŸèƒ½ã€‚</p><p>ç”±äºtf2æ˜¯ä¸€ä¸ªé‡å¤§çš„å˜åŒ–ï¼Œtf APIä¸€ç›´ä¿æŒç°æœ‰çš„å½¢å¼ã€‚ç”±äºtf2å…·æœ‰tfç‰¹æ€§çš„è¶…é›†å’Œä¸€éƒ¨åˆ†ä¾èµ–å…³ç³»ï¼Œæ‰€ä»¥tfå®ç°å·²ç»è¢«ç§»é™¤ï¼Œå¹¶è¢«å¼•ç”¨åˆ°tf2ä¸‹ã€‚è¿™æ„å‘³ç€æ‰€æœ‰ç”¨æˆ·éƒ½å°†ä¸tf2å…¼å®¹ã€‚å®˜ç½‘å»ºè®®æ–°å·¥ä½œç›´æ¥ä½¿ç”¨tf2ï¼Œå› ä¸ºå®ƒæœ‰ä¸€ä¸ªæ›´æ¸…æ´çš„ç•Œé¢ï¼Œå’Œæ›´å¥½çš„ä½¿ç”¨ä½“éªŒã€‚</p><p>å¦‚ä½•æŸ¥çœ‹è‡ªå·±ä½¿ç”¨çš„TFæ˜¯å“ªä¸€ä¸ªç‰ˆæœ¬ï¼Œä½¿ç”¨å‘½ä»¤<code>rostopic info /tf</code>å³å¯ã€‚</p><h2 id="24-æ ¼å¼å®šä¹‰"><a class="markdownIt-Anchor" href="#24-æ ¼å¼å®šä¹‰"></a> 2.4. æ ¼å¼å®šä¹‰</h2><p>tf/tfMessage.msgæˆ–tf2_msgs/TFMessageæ ‡å‡†æ ¼å¼è§„èŒƒå¦‚ä¸‹:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">geometry_msgs/TransformStamped[] transforms</span><br><span class="line">        std_msgs/Header header</span><br><span class="line">                uint32 seq</span><br><span class="line">                time stamp</span><br><span class="line">                string frame_id</span><br><span class="line">        string child_frame_id</span><br><span class="line">        geometry_msgs/Transform transform</span><br><span class="line">                geometry_msgs/Vector3 translation</span><br><span class="line">                        float64 x</span><br><span class="line">                        float64 y</span><br><span class="line">                        float64 z</span><br><span class="line">                geometry_msgs/Quaternion rotation</span><br><span class="line">                        float64 x</span><br><span class="line">                        float64 y</span><br><span class="line">                        flaot64 z</span><br><span class="line">                        float64 w</span><br></pre></td></tr></table></figure><p>å¦‚ä¸Šï¼Œä¸€ä¸ªTransformStampedæ•°ç»„å°±æ˜¯ä¸€ä¸ªTF treeã€‚</p><h1 id="3-tf-in-c"><a class="markdownIt-Anchor" href="#3-tf-in-c"></a> 3. tf in c++</h1><h2 id="31-ç®€ä»‹"><a class="markdownIt-Anchor" href="#31-ç®€ä»‹"></a> 3.1. ç®€ä»‹</h2><p>å‰é¢å†…å®¹æˆ‘ä»¬ä»‹ç»äº†TFçš„åŸºæœ¬çš„æ¦‚å¿µå’ŒTFæ ‘æ¶ˆæ¯çš„æ ¼å¼ç±»å‹ï¼Œæˆ‘ä»¬çŸ¥é“ï¼ŒTFä¸ä»…ä»…æ˜¯ä¸€ä¸ªæ ‡å‡†ã€è¯é¢˜ï¼Œå®ƒè¿˜æ˜¯ä¸€ä¸ªæ¥å£ã€‚æœ¬èŠ‚è¯¾æˆ‘ä»¬å°±ä»‹ç»c++ä¸­TFçš„ä¸€äº›å‡½æ•°å’Œå†™æ³•ã€‚</p><h2 id="32-æ•°æ®ç±»å‹"><a class="markdownIt-Anchor" href="#32-æ•°æ®ç±»å‹"></a> 3.2. æ•°æ®ç±»å‹</h2><p>C++ä¸­ç»™æˆ‘ä»¬æä¾›äº†å¾ˆå¤šTFçš„æ•°æ®ç±»å‹ï¼Œå¦‚ä¸‹è¡¨ï¼š</p><table><thead><tr><th style="text-align:center">åç§°</th><th style="text-align:center">æ•°æ®ç±»å‹</th></tr></thead><tbody><tr><td style="text-align:center">å‘é‡</td><td style="text-align:center">tf::Vector3</td></tr><tr><td style="text-align:center">ç‚¹</td><td style="text-align:center">tf::Point</td></tr><tr><td style="text-align:center">å››å…ƒæ•°</td><td style="text-align:center">tf::Quaternion</td></tr><tr><td style="text-align:center">3*3çŸ©é˜µï¼ˆæ—‹è½¬çŸ©é˜µï¼‰</td><td style="text-align:center">tf::Matrix3x3</td></tr><tr><td style="text-align:center">ä½å§¿</td><td style="text-align:center">tf::pose</td></tr><tr><td style="text-align:center">å˜æ¢</td><td style="text-align:center">tf::Transform</td></tr><tr><td style="text-align:center">å¸¦æ—¶é—´æˆ³çš„ä»¥ä¸Šç±»å‹</td><td style="text-align:center">tf::Stamped</td></tr><tr><td style="text-align:center">å¸¦æ—¶é—´æˆ³çš„å˜æ¢</td><td style="text-align:center">tf::StampedTransform</td></tr></tbody></table><p>**æ˜“æ··æ³¨æ„ï¼š**è™½ç„¶æ­¤è¡¨çš„æœ€åå¸¦æ—¶é—´æˆ³çš„å˜æ¢æ•°æ®ç±»å‹ä¸ºtf::StampedTransform,å’Œä¸ŠèŠ‚æˆ‘ä»¬æ‰€è®²çš„geometry_msgs/TransformStamped.msgçœ‹èµ·æ¥å¾ˆç›¸ä¼¼ï¼Œä½†æ˜¯å…¶å®æ•°æ®ç±»å‹å®Œå…¨ä¸ä¸€æ ·ï¼Œtf::StampedTransformåªèƒ½ç”¨åœ¨C<ins>é‡Œï¼Œåªæ˜¯C</ins>çš„ä¸€ä¸ªç±»ï¼Œä¸€ç§æ•°æ®æ ¼å¼ï¼Œå¹¶ä¸æ˜¯ä¸€ä¸ªæ¶ˆæ¯ã€‚è€Œgeometry_msgs/TransformStamped.msgæ˜¯ä¸€ä¸ªmessage,å®ƒä¾èµ–äºROSï¼Œä¸è¯­è¨€æ— å…³ï¼Œä¹Ÿå³æ˜¯æ— è®ºä½•ç§è¯­è¨€ï¼ŒC++ã€Pythonã€Javaç­‰ç­‰ï¼Œéƒ½å¯ä»¥å‘é€è¯¥æ¶ˆæ¯ã€‚</p><h2 id="33-æ•°æ®è½¬æ¢"><a class="markdownIt-Anchor" href="#33-æ•°æ®è½¬æ¢"></a> 3.3. æ•°æ®è½¬æ¢</h2><p><img src="/img/private/loading-4.gif" data-lazy-src="https://sychaichangkun.gitbooks.io/ros-tutorial-icourse163/content/pics/tf_translate.png" alt="img"></p><p>åœ¨TFé‡Œæœ‰å¯èƒ½ä¼šé‡åˆ°å„ç§å„æ ·æ•°æ®çš„è½¬æ¢ï¼Œä¾‹å¦‚å¸¸è§çš„å››å…ƒæ•°ã€æ—‹è½¬çŸ©é˜µã€æ¬§æ‹‰è§’è¿™ä¸‰ç§æ•°æ®ä¹‹é—´çš„è½¬æ¢ã€‚tf in roscppç»™äº†æˆ‘ä»¬è§£å†³è¯¥é—®é¢˜çš„å‡½æ•°ã€‚è¯¦ç»†æºç åœ¨æˆ‘ä»¬æ•™å­¦è¯¾ç¨‹çš„ä»£ç åŒ…ä¸­ã€‚ é¦–å…ˆåœ¨tfä¸­ä¸æ•°æ®è½¬åŒ–çš„æ•°æ®éƒ½ç±»å‹éƒ½åŒ…å«åœ¨<code>#include</code>å¤´æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬å°†ä¸æ•°æ®è½¬æ¢ç›¸å…³APIéƒ½å­˜åœ¨tf_demoä¸­çš„coordinate_transformation.cppå½“ä¸­ï¼Œå…¶ä¸­åˆ—è¡¨å¦‚ä¸‹ï¼š</p><h2 id="34-ç¬¬1éƒ¨åˆ†å®šä¹‰ç©ºé—´ç‚¹å’Œç©ºé—´å‘é‡"><a class="markdownIt-Anchor" href="#34-ç¬¬1éƒ¨åˆ†å®šä¹‰ç©ºé—´ç‚¹å’Œç©ºé—´å‘é‡"></a> 3.4. ç¬¬1éƒ¨åˆ†å®šä¹‰ç©ºé—´ç‚¹å’Œç©ºé—´å‘é‡</h2><table><thead><tr><th style="text-align:center">ç¼–å·</th><th style="text-align:center">å‡½æ•°åç§°</th><th style="text-align:center">å‡½æ•°åŠŸèƒ½</th></tr></thead><tbody><tr><td style="text-align:center">1.1</td><td style="text-align:center">tfScalar::tfDot(const Vector3 &amp;v1, const Vector3 &amp;v2)</td><td style="text-align:center">è®¡ç®—ä¸¤ä¸ªå‘é‡çš„ç‚¹ç§¯</td></tr><tr><td style="text-align:center">1.2</td><td style="text-align:center">tfScalar length()</td><td style="text-align:center">è®¡ç®—å‘é‡çš„æ¨¡</td></tr><tr><td style="text-align:center">1.3</td><td style="text-align:center">Vector3 &amp;normalize()</td><td style="text-align:center">æ±‚ä¸å·²çŸ¥å‘é‡åŒæ–¹å‘çš„å•ä½å‘é‡</td></tr><tr><td style="text-align:center">1.4</td><td style="text-align:center">tfScalar::tfAngle(const Vector3 &amp;v1, const Vector3 &amp;v2)</td><td style="text-align:center">è®¡ç®—ä¸¤ä¸ªå‘é‡çš„å¤¹è§’</td></tr><tr><td style="text-align:center">1.5</td><td style="text-align:center">tfScale::tfDistance(const Vector3 &amp;v1, const Vector3 &amp;v2)</td><td style="text-align:center">è®¡ç®—ä¸¤ä¸ªå‘é‡çš„è·ç¦»</td></tr><tr><td style="text-align:center">1.6</td><td style="text-align:center">tfScale::tfCross(const Vector3 &amp;v1,const Vector3 &amp;v2)</td><td style="text-align:center">è®¡ç®—ä¸¤ä¸ªå‘é‡çš„ä¹˜ç§¯</td></tr></tbody></table><p>ç¤ºä¾‹ä»£ç ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;ros/ros.h&gt;</span><br><span class="line">#include &lt;tf/tf.h&gt;</span><br><span class="line">//é€€å‡ºç”¨ï¼šctrl+z</span><br><span class="line">int main(int argc, char** argv)&#123;</span><br><span class="line">//åˆå§‹åŒ–</span><br><span class="line">ros::init(argc, argv, &quot;coordinate_transformation&quot;);</span><br><span class="line">ros::NodeHandle node;</span><br><span class="line">tf::Vector3 v1(1,1,1);</span><br><span class="line">tf::Vector3 v2(1,0,1);</span><br><span class="line">//ç¬¬1éƒ¨åˆ†ï¼Œå®šä¹‰ç©ºé—´ç‚¹å’Œç©ºé—´å‘é‡</span><br><span class="line">std::cout&lt;&lt;&quot;ç¬¬1éƒ¨åˆ†ï¼Œå®šä¹‰ç©ºé—´ç‚¹å’Œç©ºé—´å‘é‡&quot;&lt;&lt;std::endl;</span><br><span class="line">//1.1 è®¡ç®—ä¸¤ä¸ªå‘é‡çš„ç‚¹ç§¯</span><br><span class="line">std::cout&lt;&lt;&quot;å‘é‡v1:&quot;&lt;&lt;&quot;(&quot;&lt;&lt;v1[0]&lt;&lt;&quot;,&quot;&lt;&lt;v1[1]&lt;&lt;&quot;,&quot;&lt;&lt;v1[2]&lt;&lt;&quot;),&quot;;</span><br><span class="line">std::cout&lt;&lt;&quot;å‘é‡v2:&quot;&lt;&lt;&quot;(&quot;&lt;&lt;v2[0]&lt;&lt;&quot;,&quot;&lt;&lt;v2[1]&lt;&lt;&quot;,&quot;&lt;&lt;v2[2]&lt;&lt;&quot;)&quot;&lt;&lt;std::endl;</span><br><span class="line">std::cout&lt;&lt;&quot;ä¸¤ä¸ªå‘é‡çš„ç‚¹ç§¯ï¼š&quot;&lt;&lt;tfDot(v1,v2)&lt;&lt;std::endl;</span><br><span class="line">//1.2 è®¡ç®—å‘é‡çš„æ¨¡</span><br><span class="line">std::cout&lt;&lt;&quot;å‘é‡v2çš„æ¨¡å€¼:&quot;&lt;&lt;v2.length()&lt;&lt;std::endl;</span><br><span class="line">//1.3 æ±‚ä¸å·²çŸ¥å‘é‡åŒæ–¹å‘çš„å•ä½å‘é‡</span><br><span class="line">tf::Vector3 v3;</span><br><span class="line">v3=v2.normalize();</span><br><span class="line">std::cout&lt;&lt;&quot;ä¸å‘é‡v2çš„åŒæ–¹å‘çš„å•ä½å‘é‡v3:&quot;&lt;&lt;&quot;(&quot;&lt;&lt;v3[0]&lt;&lt;&quot;,&quot;&lt;&lt;v3[1]&lt;&lt;&quot;,&quot;&lt;&lt;v3[2]&lt;&lt;&quot;)&quot;&lt;&lt;std::endl;</span><br><span class="line">//1.4 è®¡ç®—ä¸¤ä¸ªå‘é‡çš„å¤¹è§’</span><br><span class="line">std::cout&lt;&lt;&quot;ä¸¤ä¸ªå‘é‡çš„å¤¹è§’(å¼§åº¦):&quot;&lt;&lt;tfAngle(v1,v2)&lt;&lt;std::endl;</span><br><span class="line">//1.5 è®¡ç®—ä¸¤ä¸ªå‘é‡çš„è·ç¦»</span><br><span class="line">std::cout&lt;&lt;&quot;ä¸¤ä¸ªå‘é‡çš„è·ç¦»:&quot;&lt;&lt;tfDistance2(v1,v2)&lt;&lt;std::endl;</span><br><span class="line">//1.6 è®¡ç®—ä¸¤ä¸ªå‘é‡çš„ä¹˜ç§¯</span><br><span class="line">tf::Vector3 v4;</span><br><span class="line">v4=tfCross(v1,v2);</span><br><span class="line">std::cout&lt;&lt;&quot;ä¸¤ä¸ªå‘é‡çš„ä¹˜ç§¯v4:&quot;&lt;&lt;&quot;(&quot;&lt;&lt;v4[0]&lt;&lt;&quot;,&quot;&lt;&lt;v4[1]&lt;&lt;&quot;,&quot;&lt;&lt;v4[2]&lt;&lt;&quot;)&quot;&lt;&lt;std::endl;</span><br><span class="line">return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="35-ç¬¬2éƒ¨åˆ†å®šä¹‰å››å…ƒæ•°"><a class="markdownIt-Anchor" href="#35-ç¬¬2éƒ¨åˆ†å®šä¹‰å››å…ƒæ•°"></a> 3.5. ç¬¬2éƒ¨åˆ†å®šä¹‰å››å…ƒæ•°</h2><table><thead><tr><th style="text-align:center">ç¼–å·</th><th style="text-align:center">å‡½æ•°åç§°</th><th style="text-align:center">å‡½æ•°åŠŸèƒ½</th></tr></thead><tbody><tr><td style="text-align:center">2.1</td><td style="text-align:center">setRPY(const tfScalar&amp; yaw, const stScalar &amp;pitch, const tfScalar &amp;roll)</td><td style="text-align:center">ç”±æ¬§æ‹‰è§’è®¡ç®—å››å…ƒæ•°</td></tr><tr><td style="text-align:center">2.2</td><td style="text-align:center">Vector3 getAxis()</td><td style="text-align:center">ç”±å››å…ƒæ•°å¾—åˆ°æ—‹è½¬è½´</td></tr><tr><td style="text-align:center">2.3</td><td style="text-align:center">setRotation(const Vector3 &amp;axis, const tfScalar&amp; angle)</td><td style="text-align:center">å·²çŸ¥æ—‹è½¬è½´å’Œæ—‹è½¬è§’ä¼°è®¡å››å…ƒæ•°</td></tr></tbody></table><p>ç¤ºä¾‹ä»£ç ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;ros/ros.h&gt;</span><br><span class="line">#include &lt;tf/tf.h&gt;</span><br><span class="line">//é€€å‡ºç”¨ï¼šctrl+z</span><br><span class="line">int main(int argc, char** argv)&#123;</span><br><span class="line">//åˆå§‹åŒ–</span><br><span class="line">ros::init(argc, argv, &quot;coordinate_transformation&quot;);</span><br><span class="line">ros::NodeHandle node;</span><br><span class="line">std::cout&lt;&lt;&quot;ç¬¬2éƒ¨åˆ†ï¼Œå®šä¹‰å››å…ƒæ•°&quot;&lt;&lt;std::endl;</span><br><span class="line">//2.1 ç”±æ¬§æ‹‰è§’è®¡ç®—å››å…ƒæ•°</span><br><span class="line">tfScalar yaw,pitch,roll;</span><br><span class="line">yaw=0;pitch=0;roll=0;</span><br><span class="line">std::cout&lt;&lt;&quot;æ¬§æ‹‰è§’rpy(&quot;&lt;&lt;roll&lt;&lt;&quot;,&quot;&lt;&lt;pitch&lt;&lt;&quot;,&quot;&lt;&lt;yaw&lt;&lt;&quot;)&quot;;</span><br><span class="line">tf::Quaternion q;</span><br><span class="line">q.setRPY(yaw,pitch,roll);</span><br><span class="line">std::cout&lt;&lt;&quot;ï¼Œè½¬åŒ–åˆ°å››å…ƒæ•°q:&quot;&lt;&lt;&quot;(&quot;&lt;&lt;q[3]&lt;&lt;&quot;,&quot;&lt;&lt;q[0]&lt;&lt;&quot;,&quot;&lt;&lt;q[1]&lt;&lt;&quot;,&quot;&lt;&lt;q[2]&lt;&lt;&quot;)&quot;&lt;&lt;std::endl;</span><br><span class="line">//2.2 ç”±å››å…ƒæ•°å¾—åˆ°æ—‹è½¬è½´</span><br><span class="line">tf::Vector3 v5;</span><br><span class="line">v5=q.getAxis();</span><br><span class="line">std::cout&lt;&lt;&quot;å››å…ƒæ•°qçš„æ—‹è½¬è½´v5&quot;&lt;&lt;&quot;(&quot;&lt;&lt;v5[0]&lt;&lt;&quot;,&quot;&lt;&lt;v5[1]&lt;&lt;&quot;,&quot;&lt;&lt;v5[2]&lt;&lt;&quot;)&quot;&lt;&lt;std::endl;</span><br><span class="line">//2.3 ç”±æ—‹è½¬è½´å’Œæ—‹è½¬è§’æ¥ä¼°è®¡å››å…ƒæ•°</span><br><span class="line">tf::Quaternion q2;</span><br><span class="line">q2.setRotation(v5,1.570796);</span><br><span class="line">std::cout&lt;&lt;&quot;æ—‹è½¬è½´v5å’Œæ—‹è½¬è§’åº¦90åº¦ï¼Œè½¬åŒ–åˆ°å››å…ƒæ•°q2:&quot;&lt;&lt;&quot;(&quot;&lt;&lt;q2[3]&lt;&lt;&quot;,&quot;&lt;&lt;q2[0]&lt;&lt;&quot;,&quot;&lt;&lt;q2[1]&lt;&lt;&quot;,&quot;&lt;&lt;q2[2]&lt;&lt;&quot;)&quot;&lt;&lt;std::endl;</span><br><span class="line">return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="36-ç¬¬3éƒ¨åˆ†å®šä¹‰æ—‹è½¬çŸ©é˜µ"><a class="markdownIt-Anchor" href="#36-ç¬¬3éƒ¨åˆ†å®šä¹‰æ—‹è½¬çŸ©é˜µ"></a> 3.6. ç¬¬3éƒ¨åˆ†å®šä¹‰æ—‹è½¬çŸ©é˜µ</h2><table><thead><tr><th style="text-align:center">ç¼–å·</th><th style="text-align:center">å‡½æ•°åç§°</th><th style="text-align:center">å‡½æ•°åŠŸèƒ½</th></tr></thead><tbody><tr><td style="text-align:center">3.1</td><td style="text-align:center">setRotaion(const Quaternion &amp;q)</td><td style="text-align:center">é€šè¿‡å››å…ƒæ•°å¾—åˆ°æ—‹è½¬çŸ©é˜µ</td></tr><tr><td style="text-align:center">3.2</td><td style="text-align:center">getEulerYPR(tfScalar &amp;yaw, tfScalar &amp;pitch, tfScalar &amp;roll )</td><td style="text-align:center">ç”±æ—‹è½¬çŸ©é˜µæ±‚æ¬§æ‹‰è§’</td></tr></tbody></table><p>ç¤ºä¾‹ä»£ç ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;ros/ros.h&gt;</span><br><span class="line">#include &lt;tf/tf.h&gt;</span><br><span class="line">//é€€å‡ºç”¨ï¼šctrl+z</span><br><span class="line">int main(int argc, char** argv)&#123;</span><br><span class="line">//åˆå§‹åŒ–</span><br><span class="line">ros::init(argc, argv, &quot;coordinate_transformation&quot;);</span><br><span class="line">ros::NodeHandle node;</span><br><span class="line">//ç¬¬3éƒ¨åˆ†ï¼Œå®šä¹‰æ—‹è½¬çŸ©é˜µ</span><br><span class="line">std::cout&lt;&lt;&quot;ç¬¬3éƒ¨åˆ†ï¼Œå®šä¹‰æ—‹è½¬çŸ©é˜µ&quot;&lt;&lt;std::endl;</span><br><span class="line">//3.1 ç”±æ—‹è½¬è½´å’Œæ—‹è½¬è§’æ¥ä¼°è®¡å››å…ƒæ•°</span><br><span class="line">tf::Quaternion q2(1,0ï¼Œ0,0ï¼‰;</span><br><span class="line">tf::Matrix3x3 Matrix;</span><br><span class="line">tf::Vector3 v6,v7,v8;</span><br><span class="line">Matrix.setRotation(q2);</span><br><span class="line">v6=Matrix[0];</span><br><span class="line">v7=Matrix[1];</span><br><span class="line">v8=Matrix[2];</span><br><span class="line">std::cout&lt;&lt;&quot;å››å…ƒæ•°q2å¯¹åº”çš„æ—‹è½¬çŸ©é˜µM:&quot;&lt;&lt;v6[0]&lt;&lt;&quot;,&quot;&lt;&lt;v6[1]&lt;&lt;&quot;,&quot;&lt;&lt;v6[2]&lt;&lt;std::endl;</span><br><span class="line">std::cout&lt;&lt;&quot;                       &quot;&lt;&lt;v7[0]&lt;&lt;&quot;,&quot;&lt;&lt;v7[1]&lt;&lt;&quot;,&quot;&lt;&lt;v7[2]&lt;&lt;std::endl;</span><br><span class="line">std::cout&lt;&lt;&quot;                       &quot;&lt;&lt;v8[0]&lt;&lt;&quot;,&quot;&lt;&lt;v8[1]&lt;&lt;&quot;,&quot;&lt;&lt;v8[2]&lt;&lt;std::endl;</span><br><span class="line">//3.2 é€šè¿‡æ—‹è½¬çŸ©é˜µæ±‚æ¬§æ‹‰è§’</span><br><span class="line">tfScalar m_yaw,m_pitch,m_roll;</span><br><span class="line">Matrix.getEulerYPR(m_yaw,m_pitch,m_roll);</span><br><span class="line">std::cout&lt;&lt;&quot;ç”±æ—‹è½¬çŸ©é˜µM,å¾—åˆ°æ¬§æ‹‰è§’rpy(&quot;&lt;&lt;m_roll&lt;&lt;&quot;,&quot;&lt;&lt;m_pitch&lt;&lt;&quot;,&quot;&lt;&lt;m_yaw&lt;&lt;&quot;)&quot;&lt;&lt;std::endl;</span><br><span class="line">return 0;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>æ­¤å¤–ï¼Œåœ¨tf_demoçš„æ•™å­¦åŒ…ä¸­ï¼Œæˆ‘ä»¬è¿˜æä¾›å¸¸è§çš„æ¬§æ‹‰è§’ä¸å››å…ƒæ•°çš„äº’æ¢ï¼Œè¯¦è§Euler2Quaternion.cppä¸Quaternion2Euler.cpp Euler2Quaternion.cpp</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;ros/ros.h&gt;</span><br><span class="line">#include &lt;tf/tf.h&gt;</span><br><span class="line">//é€€å‡ºç”¨ï¼šctrl+z</span><br><span class="line">int main(int argc, char** argv)&#123;</span><br><span class="line">//åˆå§‹åŒ–</span><br><span class="line">  ros::init(argc, argv, &quot;Euler2Quaternion&quot;);</span><br><span class="line">  ros::NodeHandle node;</span><br><span class="line">  geometry_msgs::Quaternion q;</span><br><span class="line">  double roll,pitch,yaw;</span><br><span class="line">  while(ros::ok())</span><br><span class="line">  &#123;</span><br><span class="line">  //è¾“å…¥ä¸€ä¸ªç›¸å¯¹åŸç‚¹çš„ä½ç½®</span><br><span class="line">  std::cout&lt;&lt;&quot;è¾“å…¥çš„æ¬§æ‹‰è§’ï¼šroll,pitch,yaw:&quot;;</span><br><span class="line">  std::cin&gt;&gt;roll&gt;&gt;pitch&gt;&gt;yaw;</span><br><span class="line">  //è¾“å…¥æ¬§æ‹‰è§’ï¼Œè½¬åŒ–æˆå››å…ƒæ•°åœ¨ç»ˆç«¯è¾“å‡º</span><br><span class="line"> q=tf::createQuaternionMsgFromRollPitchYaw(roll,pitch,yaw);</span><br><span class="line">  //ROS_INFO(&quot;è¾“å‡ºçš„å››å…ƒæ•°ä¸ºï¼šw=%d,x=%d,y=%d,z=%d&quot;ï¼Œq.w,q.x,q.y,q.z);</span><br><span class="line">  std::cout&lt;&lt;&quot;è¾“å‡ºçš„å››å…ƒæ•°ä¸ºï¼šw=&quot;&lt;&lt;q.w&lt;&lt;&quot;,x=&quot;&lt;&lt;q.x&lt;&lt;&quot;,y=&quot;&lt;&lt;q.y&lt;&lt;&quot;,z=&quot;&lt;&lt;q.z&lt;&lt;std::endl;</span><br><span class="line">  ros::spinOnce();</span><br><span class="line">  &#125;</span><br><span class="line">  return 0;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>Quaternion2Euler.cpp</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;ros/ros.h&gt;</span><br><span class="line">#include &quot;nav_msgs/Odometry.h&quot;</span><br><span class="line">#include &lt;tf/tf.h&gt;</span><br><span class="line">//é€€å‡ºç”¨ï¼šctrl+z</span><br><span class="line">int main(int argc, char** argv)&#123;</span><br><span class="line">//åˆå§‹åŒ–</span><br><span class="line">  ros::init(argc, argv, &quot;Quaternion2Euler&quot;);</span><br><span class="line">  ros::NodeHandle node;</span><br><span class="line">  nav_msgs::Odometry position;</span><br><span class="line">  tf::Quaternion RQ2;  </span><br><span class="line">  double roll,pitch,yaw;</span><br><span class="line">  while(ros::ok())</span><br><span class="line">  &#123;</span><br><span class="line">  //è¾“å…¥ä¸€ä¸ªç›¸å¯¹åŸç‚¹çš„ä½ç½®</span><br><span class="line">  std::cout&lt;&lt;&quot;è¾“å…¥çš„å››å…ƒæ•°ï¼šw,x,y,z:&quot;;</span><br><span class="line">  std::cin&gt;&gt;position.pose.pose.orientation.w&gt;&gt;position.pose.pose.orientation.x&gt;&gt;position.pose.pose.orientation.y&gt;&gt;position.pose.pose.orientation.z;</span><br><span class="line">  //è¾“å…¥å››å…ƒæ•°ï¼Œè½¬åŒ–æˆæ¬§æ‹‰è§’æ•°åœ¨ç»ˆç«¯è¾“å‡º</span><br><span class="line">  tf::quaternionMsgToTF(position.pose.pose.orientation,RQ2);  </span><br><span class="line"> // tf::Vector3 m_vector3; æ–¹æ³•2</span><br><span class="line"> // m_vector3=RQ2.getAxis();</span><br><span class="line">  tf::Matrix3x3(RQ2).getRPY(roll,pitch,yaw);  </span><br><span class="line">  std::cout&lt;&lt;&quot;è¾“å‡ºçš„æ¬§æ‹‰è§’ä¸ºï¼šroll=&quot;&lt;&lt;roll&lt;&lt;&quot;,pitch=&quot;&lt;&lt;pitch&lt;&lt;&quot;,yaw=&quot;&lt;&lt;yaw&lt;&lt;std::endl;</span><br><span class="line">  //std::cout&lt;&lt;&quot;è¾“å‡ºæ¬§æ‹‰è§’ä¸ºï¼šroll=&quot;&lt;&lt;m_vector3[0]&lt;&lt;&quot;,pitch=&quot;&lt;&lt;m_vector3[1]&lt;&lt;&quot;,yaw=&quot;&lt;&lt;m_vector3[2]&lt;&lt;std::endl;</span><br><span class="line">  ros::spinOnce();</span><br><span class="line">  &#125;</span><br><span class="line">  return 0;</span><br><span class="line">&#125;;    </span><br></pre></td></tr></table></figure><h2 id="37-tfç±»"><a class="markdownIt-Anchor" href="#37-tfç±»"></a> 3.7. TFç±»</h2><h2 id="38-tftransformbroadcasterç±»"><a class="markdownIt-Anchor" href="#38-tftransformbroadcasterç±»"></a> 3.8. tf::TransformBroadcasterç±»</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">transformBroadcaster()</span><br><span class="line">void sendTransform(const StampedTransform &amp;transform)</span><br><span class="line">void sendTransform(const std::vector&lt;StampedTransform&gt; &amp;transforms)</span><br><span class="line">void sendTransform(const geometry_msgs::TransformStamped &amp;transform)</span><br><span class="line">void sendTransform(const std::vector&lt;geometry_msgs::TransformStamped&gt; &amp;transforms)</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªç±»åœ¨å‰é¢è®²TFæ ‘çš„æ—¶å€™æåˆ°è¿‡ï¼Œè¿™ä¸ªbroadcasterå°±æ˜¯ä¸€ä¸ªpublisher,è€ŒsendTransformçš„ä½œç”¨æ˜¯æ¥å°è£…publishçš„å‡½æ•°ã€‚åœ¨å®é™…çš„ä½¿ç”¨ä¸­ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æŸä¸ªNodeä¸­æ„å»ºtf::TransformBroadcasterç±»ï¼Œç„¶åè°ƒç”¨sendTransform(),å°†transformå‘å¸ƒåˆ°<code>/tf</code>çš„ä¸€æ®µtransformä¸Šã€‚<code>/tf</code>é‡Œçš„transformä¸ºæˆ‘ä»¬é‡è½½äº†å¤šç§ä¸åŒçš„å‡½æ•°ç±»å‹ã€‚åœ¨æˆ‘ä»¬çš„tf_demoæ•™å­¦åŒ…å½“ä¸­æä¾›äº†ç›¸å…³çš„ç¤ºä¾‹ä»£ç tf.broadcaster.cppï¼Œå…·ä½“å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;ros/ros.h&gt;</span><br><span class="line">#include &lt;tf/transform_broadcaster.h&gt;</span><br><span class="line">#include &lt;tf/tf.h&gt;</span><br><span class="line">//é€€å‡ºç”¨ï¼šctrl+z</span><br><span class="line">int main(int argc, char** argv)&#123;</span><br><span class="line">//åˆå§‹åŒ–</span><br><span class="line">  ros::init(argc, argv, &quot;tf_broadcaster&quot;);</span><br><span class="line">  ros::NodeHandle node;</span><br><span class="line">  static tf::TransformBroadcaster br;</span><br><span class="line">  tf::Transform transform;</span><br><span class="line">  //geometry_msgs::Quaternion qw;</span><br><span class="line">  tf::Quaternion q;</span><br><span class="line">  //å®šä¹‰åˆå§‹åæ ‡å’Œè§’åº¦</span><br><span class="line">  double roll=0,pitch=0,yaw=0,x=1.0,y=2.0,z=3.0;</span><br><span class="line">  ros::Rate rate(1);</span><br><span class="line">  while(ros::ok())</span><br><span class="line">  &#123;</span><br><span class="line">  yaw+=0.1;//æ¯ç»è¿‡ä¸€ç§’å¼€å§‹ä¸€æ¬¡å˜æ¢</span><br><span class="line">  //è¾“å…¥æ¬§æ‹‰è§’ï¼Œè½¬åŒ–æˆå››å…ƒæ•°åœ¨ç»ˆç«¯è¾“å‡º</span><br><span class="line">  q.setRPY(roll,pitch,yaw);</span><br><span class="line">      //qw=tf::createQuaternionMsgFromRollPitchYaw(roll,pitch,yaw);æ–¹æ³•2</span><br><span class="line">  transform.setOrigin(tf::Vector3(x,y,z));</span><br><span class="line">  transform.setRotation(q);</span><br><span class="line">  std::cout&lt;&lt;&quot;å‘å¸ƒtfå˜æ¢ï¼šsendTransformå‡½æ•°&quot;&lt;&lt;std::endl;</span><br><span class="line">  br.sendTransform(tf::StampedTransform(transform,ros::Time::now(),&quot;base_link&quot;,&quot;link1&quot;));</span><br><span class="line">  std::cout&lt;&lt;&quot;è¾“å‡ºçš„å››å…ƒæ•°ä¸ºï¼šw=&quot;&lt;&lt;q[3]&lt;&lt;&quot;,x=&quot;&lt;&lt;q[0]&lt;&lt;&quot;,y=&quot;&lt;&lt;q[1]&lt;&lt;&quot;,z=&quot;&lt;&lt;q[2]&lt;&lt;std::endl;</span><br><span class="line">  //  std::cout&lt;&lt;&quot;è¾“å‡ºçš„å››å…ƒæ•°ä¸ºï¼šw=&quot;&lt;&lt;qw.w&lt;&lt;&quot;,x=&quot;&lt;&lt;qw.x&lt;&lt;&quot;,y=&quot;&lt;&lt;qw.y&lt;&lt;&quot;,z=&quot;&lt;&lt;qw.z&lt;&lt;std::endl;</span><br><span class="line">  rate.sleep();</span><br><span class="line">  ros::spinOnce();</span><br><span class="line">  &#125;</span><br><span class="line">  return 0;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="39-tftransformlistenerç±»"><a class="markdownIt-Anchor" href="#39-tftransformlistenerç±»"></a> 3.9. tf::TransformListenerç±»</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">void lookupTranform(const std::string &amp;target_frame,const std::string &amp;source_frame,const ros::Time &amp;time,StampedTransform &amp;transform)const</span><br><span class="line">bool canTransform()</span><br><span class="line">bool waitForTransform()const</span><br></pre></td></tr></table></figure><p>ä¸Šä¸€ä¸ªç±»æ˜¯å‘<code>/tf</code>ä¸Šå‘çš„ç±»ï¼Œé‚£ä¹ˆè¿™ä¸€ä¸ªå°±æ˜¯ä»<code>/tf</code>ä¸Šæ¥æ”¶çš„ç±»ã€‚é¦–å…ˆçœ‹lookuptransform()å‡½æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ç›®æ ‡åæ ‡ç³»ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºæºåæ ‡ç³»ï¼Œä¹Ÿå³æ˜¯å¾—åˆ°ä»æºåæ ‡ç³»åˆ°ç›®æ ‡åæ ‡ç³»ä¹‹é—´çš„è½¬æ¢å…³ç³»ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°ä¸ºæŸ¥è¯¢æ—¶åˆ»ï¼Œç¬¬å››ä¸ªå‚æ•°ä¸ºå­˜å‚¨è½¬æ¢å…³ç³»çš„ä½ç½®ã€‚å€¼å¾—æ³¨æ„ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°é€šå¸¸ç”¨<code>ros::Timeï¼ˆ0ï¼‰</code>,è¿™ä¸ªè¡¨ç¤ºä¸ºæœ€æ–°çš„åæ ‡è½¬æ¢å…³ç³»ï¼Œè€Œ<code>ros::time::now</code>åˆ™ä¼šå› ä¸ºæ”¶å‘å»¶è¿Ÿçš„åŸå› ï¼Œè€Œä¸èƒ½æ­£ç¡®è·å–å½“å‰æœ€æ–°çš„åæ ‡è½¬æ¢å…³ç³»ã€‚canTransform()æ˜¯ç”¨æ¥åˆ¤æ–­ä¸¤ä¸ªtransformä¹‹é—´æ˜¯å¦è¿é€šï¼ŒwaitForTransform()constæ˜¯ç”¨æ¥ç­‰å¾…æŸä¸¤ä¸ªtransformä¹‹é—´çš„è¿é€šï¼Œåœ¨æˆ‘ä»¬çš„tf_demoæ•™å­¦åŒ…å½“ä¸­æä¾›äº†ç›¸å…³çš„ç¤ºä¾‹ä»£ç tf_listerner.cppï¼Œå…·ä½“å¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;ros/ros.h&gt;</span><br><span class="line">#include &lt;tf/transform_listener.h&gt;</span><br><span class="line">#include &lt;geometry_msgs/Twist.h&gt;</span><br><span class="line">int main(int argc, char** argv)&#123;</span><br><span class="line">  ros::init(argc, argv, &quot;tf_listener&quot;);</span><br><span class="line">  ros::NodeHandle node;</span><br><span class="line">  tf::TransformListener listener;</span><br><span class="line">  //1. é˜»å¡ç›´åˆ°frameç›¸é€š</span><br><span class="line">  std::cout&lt;&lt;&quot;1. é˜»å¡ç›´åˆ°frameç›¸é€š&quot;&lt;&lt;std::endl;</span><br><span class="line">  listener.waitForTransform(&quot;/base_link&quot;,&quot;link1&quot;,ros::Time(0),ros::Duration(4.0));</span><br><span class="line">  ros::Rate rate(1);</span><br><span class="line">  while (node.ok())&#123;</span><br><span class="line">tf::StampedTransform transform;</span><br><span class="line">try&#123;</span><br><span class="line">  //2. ç›‘å¬å¯¹åº”çš„tf,è¿”å›å¹³ç§»å’Œæ—‹è½¬</span><br><span class="line"> std::cout&lt;&lt;&quot;2. ç›‘å¬å¯¹åº”çš„tf,è¿”å›å¹³ç§»å’Œæ—‹è½¬&quot;&lt;&lt;std::endl;</span><br><span class="line">  listener.lookupTransform(&quot;/base_link&quot;, &quot;/link1&quot;,</span><br><span class="line">                           ros::Time(0), transform);</span><br><span class="line">                           //ros::Time(0)è¡¨ç¤ºæœ€è¿‘çš„ä¸€å¸§åæ ‡å˜æ¢ï¼Œä¸èƒ½å†™æˆros::Time::now()</span><br><span class="line">&#125;</span><br><span class="line">catch (tf::TransformException &amp;ex) &#123;</span><br><span class="line">  ROS_ERROR(&quot;%s&quot;,ex.what());</span><br><span class="line">  ros::Duration(1.0).sleep();</span><br><span class="line">  continue;</span><br><span class="line">&#125;</span><br><span class="line">std::cout&lt;&lt;&quot;è¾“å‡ºçš„ä½ç½®åæ ‡ï¼šx=&quot;&lt;&lt;transform.getOrigin().x()&lt;&lt;&quot;,y=&quot;&lt;&lt;transform.getOrigin().y()&lt;&lt;&quot;,z=&quot;&lt;&lt;transform.getOrigin().z()&lt;&lt;std::endl;</span><br><span class="line">std::cout&lt;&lt;&quot;è¾“å‡ºçš„æ—‹è½¬å››å…ƒæ•°ï¼šw=&quot;&lt;&lt;transform.getRotation().getW()&lt;&lt;&quot;,x=&quot;&lt;&lt;transform.getRotation().getX()&lt;&lt;</span><br><span class="line">&quot;,y=&quot;&lt;&lt;transform.getRotation().getY()&lt;&lt;&quot;,z=&quot;&lt;&lt;transform.getRotation().getZ()&lt;&lt;std::endl;</span><br><span class="line">rate.sleep();</span><br><span class="line">  &#125;</span><br><span class="line">  return 0;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h1 id="4-tf-in-python"><a class="markdownIt-Anchor" href="#4-tf-in-python"></a> 4. tf in python</h1><h2 id="41-ç®€ä»‹"><a class="markdownIt-Anchor" href="#41-ç®€ä»‹"></a> 4.1. ç®€ä»‹</h2><p>æˆ‘ä»¬çŸ¥é“tfä¸­ä¸ä»…æœ‰C<ins>çš„æ¥å£ï¼Œä¹Ÿæœ‰Pythonçš„æ¥å£ã€‚ç›¸æ¯”C</ins>ï¼Œtfåœ¨Pythonä¸­çš„å…·ä½“å®ç°ç›¸å¯¹ç®€å•å¥½ç”¨ã€‚</p><h2 id="42-æ•°æ®ç±»å‹"><a class="markdownIt-Anchor" href="#42-æ•°æ®ç±»å‹"></a> 4.2. æ•°æ®ç±»å‹</h2><p>TFçš„ç›¸å…³æ•°æ®ç±»å‹ï¼Œ<strong>å‘é‡</strong>ã€<strong>ç‚¹</strong>ã€<strong>å››å…ƒæ•°</strong>ã€<strong>çŸ©é˜µ</strong>éƒ½å¯ä»¥è¡¨ç¤ºæˆç±»ä¼¼æ•°ç»„å½¢å¼ï¼Œå°±æ˜¯å®ƒä»¬éƒ½å¯ä»¥ç”¨<strong>Tuple</strong>ï¼Œ<strong>List</strong>ï¼Œ<strong>Numpy</strong>, <strong>Array</strong>æ¥è¡¨ç¤ºã€‚<br>ä¾‹å¦‚ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">t = (1.0,1.5,0) #å¹³ç§»</span><br><span class="line">q = [1,0,0,0] #å››å…ƒæ•°</span><br><span class="line">m = numpy.identity(3) #æ—‹è½¬çŸ©é˜µ</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€ä¸ªå¹³ç§»æ•°æ®ä½¿ç”¨Tupleè¡¨ç¤ºçš„ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥ç”¨Listè¡¨ç¤ºæˆt=[1.0,1.5,0],ä¹Ÿèƒ½ç”¨numpy.array(1.0,1.5,0)æ¥è¡¨ç¤ºéƒ½æ˜¯å¯ä»¥çš„ã€‚<strong>è¿™äº›æ•°æ®ç±»å‹æ²¡æœ‰ç‰¹æ®Šå¯¹åº”ï¼Œå…¨éƒ¨æ˜¯é€šç”¨çš„ï¼Œæ‰€ä»¥è¿™é‡Œä¹Ÿå°±æ²¡æœ‰äº†å„ç§æ•°æ®ç±»å‹çš„è½¬æ¢çš„éº»çƒ¦ã€‚</strong></p><h2 id="43-åº“"><a class="markdownIt-Anchor" href="#43-åº“"></a> 4.3. åº“</h2><h2 id="44-tftransformations"><a class="markdownIt-Anchor" href="#44-tftransformations"></a> 4.4. tf.transformations</h2><p>åŸºæœ¬æ•°å­¦è¿ç®—å‡½æ•°</p><table><thead><tr><th style="text-align:center">å‡½æ•°</th><th style="text-align:center">æ³¨é‡Š</th></tr></thead><tbody><tr><td style="text-align:center">euler_matrix(ai,aj,ak,axes=â€˜sxyzâ€™)</td><td style="text-align:center">æ¬§æ‹‰è§’åˆ°çŸ©é˜µ</td></tr><tr><td style="text-align:center">eulaer_form_matrix(matrix,axes=â€˜sxyzâ€™)</td><td style="text-align:center">çŸ©é˜µåˆ°æ¬§æ‹‰è§’</td></tr><tr><td style="text-align:center">eular_from_quaternion(quaternion,axes=â€˜sxyzâ€™)</td><td style="text-align:center">å››å…ƒæ•°åˆ°æ¬§æ‹‰è§’</td></tr><tr><td style="text-align:center">quaternion_form_euler(ai,aj,ak,axes=â€˜sxyzâ€™)</td><td style="text-align:center">æ¬§æ‹‰è§’åˆ°å››å…ƒæ•°</td></tr><tr><td style="text-align:center">quaternion_matrix(quaternion)</td><td style="text-align:center">å››å…ƒæ•°åˆ°çŸ©é˜µ</td></tr><tr><td style="text-align:center">quaternion_form_matrix(matrix)</td><td style="text-align:center">çŸ©é˜µåˆ°å››å…ƒæ•°</td></tr><tr><td style="text-align:center">â€¦</td><td style="text-align:center">â€¦</td></tr></tbody></table><p>ä½¿ç”¨è¯¥å‡½æ•°åº“æ—¶å€™ï¼Œé¦–å…ˆ<code>import tf</code>ï¼Œtf.transformationsç»™æˆ‘ä»¬æä¾›äº†<strong>ä¸€äº›åŸºæœ¬çš„æ•°å­¦è¿ç®—å‡½æ•°</strong>å¦‚ä¸Šï¼Œä½¿ç”¨èµ·æ¥éå¸¸æ–¹ä¾¿ã€‚åœ¨tf_demoä¸­æ•™å­¦åŒ…å½“ä¸­ï¼Œæˆ‘ä»¬åˆ—ä¸¾äº†ä¸€äº›tf.transformationså¸¸è§çš„APIå’Œç¤ºä¾‹ä»£ç ï¼Œå…·è¯¦è§ä¸‹è¡¨ã€‚</p><h3 id="441-ç¬¬1éƒ¨åˆ†å®šä¹‰ç©ºé—´ç‚¹å’Œç©ºé—´å‘é‡"><a class="markdownIt-Anchor" href="#441-ç¬¬1éƒ¨åˆ†å®šä¹‰ç©ºé—´ç‚¹å’Œç©ºé—´å‘é‡"></a> 4.4.1. ç¬¬1éƒ¨åˆ†ï¼Œå®šä¹‰ç©ºé—´ç‚¹å’Œç©ºé—´å‘é‡</h3><table><thead><tr><th style="text-align:center">ç¼–å·</th><th style="text-align:center">å‡½æ•°åç§°</th><th style="text-align:center">å‡½æ•°åŠŸèƒ½</th></tr></thead><tbody><tr><td style="text-align:center">1.1</td><td style="text-align:center">tf.transformations.random_quaternion(rand=None)</td><td style="text-align:center">è¿”å›å‡åŒ€éšæœºå•ä½å››å…ƒæ•°</td></tr><tr><td style="text-align:center">1.2</td><td style="text-align:center">tf.transformations.random_rotation_matrix(rand=None)</td><td style="text-align:center">è¿”å›å‡åŒ€éšæœºå•ä½æ—‹è½¬çŸ©é˜µ</td></tr><tr><td style="text-align:center">1.3</td><td style="text-align:center">tf.transformations.random_vector(size)</td><td style="text-align:center">è¿”å›å‡åŒ€éšæœºå•ä½å‘é‡</td></tr><tr><td style="text-align:center">1.4</td><td style="text-align:center">tf.transformations.translation_matrix(v)</td><td style="text-align:center">é€šè¿‡å‘é‡æ¥æ±‚æ—‹è½¬çŸ©é˜µ</td></tr><tr><td style="text-align:center">1.5</td><td style="text-align:center">tf.transformations.translation_from_matrix(m)</td><td style="text-align:center">é€šè¿‡æ—‹è½¬çŸ©é˜µæ¥æ±‚å‘é‡</td></tr></tbody></table><h3 id="442-ç¬¬2éƒ¨åˆ†å®šä¹‰å››å…ƒæ•°"><a class="markdownIt-Anchor" href="#442-ç¬¬2éƒ¨åˆ†å®šä¹‰å››å…ƒæ•°"></a> 4.4.2. ç¬¬2éƒ¨åˆ†ï¼Œå®šä¹‰å››å…ƒæ•°</h3><table><thead><tr><th style="text-align:center">ç¼–å·</th><th style="text-align:center">å‡½æ•°åç§°</th><th style="text-align:center">å‡½æ•°åŠŸèƒ½</th></tr></thead><tbody><tr><td style="text-align:center">2.1</td><td style="text-align:center">tf.transformations.quaternion_about_axis(angle axis)</td><td style="text-align:center">é€šè¿‡æ—‹è½¬è½´å’Œæ—‹è½¬è§’è¿”å›å››å…ƒæ•°</td></tr><tr><td style="text-align:center">2.2</td><td style="text-align:center">tf.transformations.quaternion_conjugate(quaternion)</td><td style="text-align:center">è¿”å›å››å…ƒæ•°çš„å…±è½­</td></tr><tr><td style="text-align:center">2.3</td><td style="text-align:center">tf.transformations.quaternion_from_euler(ai,aj,ak, axesâ€™ryxzâ€™)</td><td style="text-align:center">ä»æ¬§æ‹‰è§’å’Œæ—‹è½¬è½´ï¼Œæ±‚å››å…ƒæ•°</td></tr><tr><td style="text-align:center">2.4</td><td style="text-align:center">tf.transformations.quaternion_from_matrix(matrix)</td><td style="text-align:center">ä»æ—‹è½¬çŸ©é˜µä¸­ï¼Œè¿”å›å››å…ƒæ•°</td></tr><tr><td style="text-align:center">2.5</td><td style="text-align:center">tf.transformations.quaternion_multiply(quaternion1,quaternion2)</td><td style="text-align:center">ä¸¤ä¸ªå››å…ƒæ•°ç›¸ä¹˜</td></tr></tbody></table><h3 id="443-ç¬¬3éƒ¨åˆ†å®šä¹‰å››å…ƒæ•°"><a class="markdownIt-Anchor" href="#443-ç¬¬3éƒ¨åˆ†å®šä¹‰å››å…ƒæ•°"></a> 4.4.3. ç¬¬3éƒ¨åˆ†ï¼Œå®šä¹‰å››å…ƒæ•°</h3><table><thead><tr><th style="text-align:center">ç¼–å·</th><th style="text-align:center">å‡½æ•°åç§°</th><th style="text-align:center">å‡½æ•°åŠŸèƒ½</th></tr></thead><tbody><tr><td style="text-align:center">3.1</td><td style="text-align:center">tf.transformations.euler_matrix(ai,aj,ak,axes=â€˜xyzâ€™)</td><td style="text-align:center">ç”±æ¬§æ‹‰è§’å’Œæ—‹è½¬è½´è¿”å›æ—‹è½¬çŸ©é˜µ</td></tr><tr><td style="text-align:center">3.2</td><td style="text-align:center">tf.transformations.euler_from_matrix(matrix)</td><td style="text-align:center">ç”±æ—‹è½¬çŸ©é˜µå’Œç‰¹å®šçš„æ—‹è½¬è½´è¿”å›æ¬§æ‹‰è§’</td></tr><tr><td style="text-align:center">3.3</td><td style="text-align:center">tf.transformations.euler_from_quaternion(quaternion)</td><td style="text-align:center">ç”±å››å…ƒæ•°å’Œç‰¹å®šçš„è½´å¾—åˆ°æ¬§æ‹‰è§’</td></tr></tbody></table><p>ç¤ºä¾‹ä»£ç ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python  </span><br><span class="line"># -*- coding:utf-8 -*-  </span><br><span class="line">import rospy  </span><br><span class="line">import math  </span><br><span class="line">import tf  </span><br><span class="line">if __name__ == &#x27;__main__&#x27;:  </span><br><span class="line">    rospy.init_node(&#x27;py_coordinate_transformation&#x27;)</span><br><span class="line">#ç¬¬1éƒ¨åˆ†ï¼Œå®šä¹‰ç©ºé—´ç‚¹å’Œç©ºé—´å‘é‡</span><br><span class="line">    print &#x27;ç¬¬1éƒ¨åˆ†ï¼Œå®šä¹‰ç©ºé—´ç‚¹å’Œç©ºé—´å‘é‡&#x27;</span><br><span class="line">#1.1 è¿”å›å‡åŒ€éšæœºå•ä½å››å…ƒæ•°</span><br><span class="line">    q=tf.transformations.random_quaternion(rand=None)</span><br><span class="line">    print &#x27;å®šä¹‰å‡åŒ€éšæœºå››å…ƒæ•°ï¼š&#x27;</span><br><span class="line">    print q</span><br><span class="line">#1.2 è¿”å›å‡åŒ€éšæœºå•ä½æ—‹è½¬çŸ©é˜µ</span><br><span class="line">    m=tf.transformations.random_rotation_matrix(rand=None)</span><br><span class="line">    print &#x27;å®šä¹‰å‡åŒ€éšæœºå•ä½æ—‹è½¬çŸ©é˜µï¼š&#x27;</span><br><span class="line">    print m</span><br><span class="line">#1.3 è¿”å›å‡åŒ€éšæœºå•ä½å‘é‡</span><br><span class="line">    v=tf.transformations.random_vector(3)</span><br><span class="line">    print &#x27;å®šä¹‰å‡åŒ€éšæœºå•ä½å‘é‡ï¼š&#x27;</span><br><span class="line">    print v</span><br><span class="line">#1.4 é€šè¿‡å‘é‡æ¥æ±‚æ—‹è½¬çŸ©é˜µ</span><br><span class="line">    v_m=tf.transformations.translation_matrix(v)</span><br><span class="line">    print &#x27;é€šè¿‡å‘é‡æ¥æ±‚æ—‹è½¬çŸ©é˜µï¼š&#x27;</span><br><span class="line">    print v_m</span><br><span class="line">#1.5 é€šè¿‡æ—‹è½¬çŸ©é˜µæ¥æ±‚å‘é‡</span><br><span class="line">    m_v=tf.transformations.translation_from_matrix(m)</span><br><span class="line">    print &#x27;é€šè¿‡æ—‹è½¬çŸ©é˜µæ¥æ±‚å‘é‡ï¼š&#x27;</span><br><span class="line">    print  m_v</span><br><span class="line">#ç¬¬2éƒ¨åˆ†ï¼Œå®šä¹‰å››å…ƒæ•°</span><br><span class="line">    print &#x27;ç¬¬2éƒ¨åˆ†ï¼Œå®šä¹‰å››å…ƒæ•°&#x27;</span><br><span class="line">#2.1 é€šè¿‡æ—‹è½¬è½´å’Œæ—‹è½¬è§’è¿”å›å››å…ƒæ•°</span><br><span class="line">    axis_q=tf.transformations.quaternion_about_axis(0.123, (1, 0, 0))</span><br><span class="line">    print &#x27;é€šè¿‡æ—‹è½¬è½´å’Œæ—‹è½¬è§’è¿”å›å››å…ƒæ•°ï¼š&#x27;</span><br><span class="line">    print  axis_q</span><br><span class="line">#2.2 è¿”å›å››å…ƒæ•°çš„å…±è½­</span><br><span class="line">    n_q=tf.transformations.quaternion_conjugate(q)</span><br><span class="line">    print &#x27;è¿”å›å››å…ƒæ•°qçš„å…±è½­ï¼š&#x27;</span><br><span class="line">    print  n_q</span><br><span class="line">#2.3 ä»æ¬§æ‹‰è§’å’Œæ—‹è½¬è½´ï¼Œæ±‚å››å…ƒæ•°</span><br><span class="line">    o_q=tf.transformations.quaternion_from_euler(1, 2, 3, &#x27;ryxz&#x27;)</span><br><span class="line">    print &#x27;ä»æ¬§æ‹‰è§’å’Œæ—‹è½¬è½´ï¼Œæ±‚å››å…ƒæ•°ï¼š&#x27;</span><br><span class="line">    print  o_q    </span><br><span class="line">#2.4 ä»æ—‹è½¬çŸ©é˜µä¸­ï¼Œè¿”å›å››å…ƒæ•°</span><br><span class="line">    m_q=tf.transformations.quaternion_from_matrix(m)</span><br><span class="line">    print &#x27;ä»æ—‹è½¬çŸ©é˜µä¸­ï¼Œè¿”å›å››å…ƒæ•°ï¼š&#x27;</span><br><span class="line">    print  m_q </span><br><span class="line">#2.5 ä¸¤ä¸ªå››å…ƒæ•°ç›¸ä¹˜</span><br><span class="line">    qxq=tf.transformations.quaternion_multiply(q,n_q)</span><br><span class="line">    print &#x27;ä¸¤ä¸ªå››å…ƒæ•°ç›¸ä¹˜&#x27;</span><br><span class="line">    print  qxq   </span><br><span class="line">`</span><br></pre></td></tr></table></figure><h2 id="45-tfç±»"><a class="markdownIt-Anchor" href="#45-tfç±»"></a> 4.5. TFç±»</h2><h3 id="451-tftransformlistenerç±»"><a class="markdownIt-Anchor" href="#451-tftransformlistenerç±»"></a> 4.5.1. tf.TransformListenerç±»</h3><table><thead><tr><th style="text-align:center">æ–¹æ³•</th><th style="text-align:center">ä½œç”¨</th></tr></thead><tbody><tr><td style="text-align:center">canTransform(self,target_frame,source_frame,time)</td><td style="text-align:center">frameæ˜¯å¦ç›¸é€š</td></tr><tr><td style="text-align:center">waitForTransform(self,target_frame,source_frame,time,timeout)</td><td style="text-align:center">é˜»å¡ç›´åˆ°frameç›¸é€š</td></tr><tr><td style="text-align:center">lookup Transform(self,target_frame,source_frame,time)</td><td style="text-align:center">æŸ¥çœ‹ç›¸å¯¹çš„tfï¼Œè¿”å›ï¼ˆtransï¼Œquatï¼‰</td></tr></tbody></table><p>tf.TransformListenerç±»ä¸­ä¸»è¦åŒ…å«ä»¥ä¸Šä¸‰ç§æ–¹æ³•ï¼Œå®ƒçš„æ„é€ å‡½æ•°ä¸éœ€è¦å¡«å€¼ã€‚æ³¨æ„è¿™é‡Œçš„timeå‚æ•°ï¼Œä¾ç„¶æ˜¯ä½¿ç”¨<code>rospy.Time(0)</code>è€Œä¸æ˜¯<code>rospy.Time.now()</code>.å…·ä½“åŸå› ä¸ŠèŠ‚å·²ç»ä»‹ç»ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚é™¤äº†ä¸Šè¿°ä¸‰ç§é‡è¦çš„æ–¹æ³•ï¼Œè¿™ä¸ªç±»ä¸­è¿˜æœ‰ä¸€äº›è¾…åŠ©ç”¨çš„æ–¹æ³•å¦‚ä¸‹ï¼š</p><table><thead><tr><th style="text-align:center">æ–¹æ³•</th><th style="text-align:center">ä½œç”¨</th></tr></thead><tbody><tr><td style="text-align:center">chain(target_frame,target_time,source_frame,source_time,fixed_frame)</td><td style="text-align:center">frameçš„è¿æ¥å…³ç³»</td></tr><tr><td style="text-align:center">frameExists(self,frame_id)</td><td style="text-align:center">frameæ˜¯å¦å­˜åœ¨</td></tr><tr><td style="text-align:center">getFrameStrings(self)</td><td style="text-align:center">è¿”å›æ‰€æœ‰tfçš„åç§°</td></tr><tr><td style="text-align:center">fromTranslationRotation(translation,rotation)</td><td style="text-align:center">æ ¹æ®å¹³ç§»å’Œæ—‹è½¬è¿”å›4X4çŸ©é˜µ</td></tr><tr><td style="text-align:center">transformPoint(target_frame,point_msg)</td><td style="text-align:center">å°†PointStampedæ¶ˆæ¯è½¬æ¢åˆ°æ–°frameä¸‹</td></tr><tr><td style="text-align:center">transformPose(target_frame,pose_msg)</td><td style="text-align:center">å°†PoseStampedæ¶ˆæ¯è½¬æ¢åˆ°æ–°frameä¸‹</td></tr><tr><td style="text-align:center">transformQuaternion(target_frame,quat_msg)</td><td style="text-align:center">å°†QuaternionStampedâ€¦è¿”å›ç›¸åŒç±»å‹</td></tr><tr><td style="text-align:center">â€¦</td><td style="text-align:center">â€¦</td></tr></tbody></table><p>åœ¨<code>tf_demo</code>æ•™å­¦åŒ…å½“ä¸­çš„<code>scripts/py_tf_listerner.py</code>ç»™å‡ºäº†ç¤ºä¾‹ç¨‹åºï¼Œè¯¦è§å¦‚ä¸‹ã€‚</p><p>py_tf_listerner.py</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python  </span><br><span class="line"># -*- coding:utf-8 -*-  </span><br><span class="line">import rospy  </span><br><span class="line">import math  </span><br><span class="line">import tf   </span><br><span class="line">if __name__ == &#x27;__main__&#x27;:  </span><br><span class="line">    rospy.init_node(&#x27;py_tf_turtle&#x27;)</span><br><span class="line">    listener = tf.TransformListener() #TransformListeneråˆ›å»ºåå°±å¼€å§‹æ¥å—tfå¹¿æ’­ä¿¡æ¯ï¼Œæœ€å¤šå¯ä»¥ç¼“å­˜10s  ç›®å‰å­˜åœ¨çš„é—®é¢˜ï¼Œæ˜¯å››ä¸ªæ•°å€¼çš„é¡ºåºæˆ‘è¿˜æœ‰ç‚¹é—®é¢˜</span><br><span class="line">    rate = rospy.Rate(1.0)  </span><br><span class="line">    #1. é˜»å¡ç›´åˆ°frameç›¸é€š</span><br><span class="line">    print &#x27;1. é˜»å¡ç›´åˆ°frameç›¸é€š&#x27;  </span><br><span class="line">    listener.waitForTransform(&quot;/base_link&quot;, &quot;/link1&quot;, rospy.Time(), rospy.Duration(4.0))</span><br><span class="line">    while not rospy.is_shutdown():  </span><br><span class="line">        try:  </span><br><span class="line">        #2. ç›‘å¬å¯¹åº”çš„tf,è¿”å›å¹³ç§»å’Œæ—‹è½¬</span><br><span class="line">            print &#x27;2. ç›‘å¬å¯¹åº”çš„tf,è¿”å›å¹³ç§»å’Œæ—‹è½¬&#x27;  </span><br><span class="line">            (trans,rot) = listener.lookupTransform(&#x27;/base_link&#x27;, &#x27;/link1&#x27;, rospy.Time(0)) #rospy.Time(0)ä¸è¡¨ç¤º0æ—¶åˆ»çš„tfï¼Œè€Œæ˜¯æŒ‡æœ€è¿‘ä¸€å¸§tf </span><br><span class="line">        except (tf.LookupException, tf.ConnectivityException, tf.ExtrapolationException):  </span><br><span class="line">            continue    </span><br><span class="line">        rospy.loginfo(&#x27;è·ç¦»åŸç‚¹çš„ä½ç½®: x=%f ,y= %fï¼Œz=%f \n æ—‹è½¬å››å…ƒæ•°: w=%f ,x= %fï¼Œy=%f z=%f &#x27;,trans[0],trans[1],trans[2],rot[0],rot[1],rot[2],rot[3])</span><br><span class="line">        #3. åˆ¤æ–­ä¸¤ä¸ªframeæ˜¯å¦ç›¸é€š</span><br><span class="line">        print &#x27;3. åˆ¤æ–­ä¸¤ä¸ªframeæ˜¯å¦ç›¸é€š&#x27;</span><br><span class="line">        if listener.canTransform(&#x27;/link1&#x27;,&#x27;/base_link&#x27;,rospy.Time(0)) :</span><br><span class="line">            print &#x27;true&#x27;</span><br><span class="line">        else :</span><br><span class="line">            print &#x27;false&#x27;</span><br><span class="line">        rate.sleep()</span><br></pre></td></tr></table></figure><h3 id="452"><a class="markdownIt-Anchor" href="#452"></a> 4.5.2.</h3><h3 id="453-tftransformbroadcasterç±»"><a class="markdownIt-Anchor" href="#453-tftransformbroadcasterç±»"></a> 4.5.3. tf.TransformBroadcasterç±»</h3><p>ç±»ä¼¼çš„ï¼Œæˆ‘ä»¬ä»‹ç»çš„æ˜¯å‘å¸ƒæ–¹ï¼Œtf.TransformBroadcasterç±»ã€‚è¯¥ç±»çš„æ„é€ å‡½æ•°ä¹Ÿæ˜¯ä¸éœ€è¦å¡«å€¼ï¼Œæˆå‘˜å‡½æ•°æœ‰ä¸¤ä¸ªå¦‚ä¸‹ï¼š</p><ul><li>sendTransform(translation,rotation,time,child,parent)#å‘/tfå‘å¸ƒæ¶ˆæ¯</li><li>sendTransformMessage(transform)#å‘/tfå‘å¸ƒæ¶ˆæ¯</li></ul><p>ç¬¬ä¸€ä¸ªsendTransform()æŠŠtransformçš„å¹³ç§»å’Œæ—‹è½¬å¡«å¥½ï¼Œæ‰“ä¸Šæ—¶é—´æˆ³ï¼Œç„¶åè¡¨ç¤ºå‡ºä»çˆ¶åˆ°å­çš„frameæµï¼Œç„¶åå‘å‘<code>/tf</code>çš„topicã€‚ç¬¬äºŒç§æ˜¯å‘é€transformå·²ç»å°è£…å¥½çš„Messageç»™<code>/tf</code>ï¼Œè¿™ä¸¤ç§ä¸åŒçš„å‘é€æ–¹å¼ï¼ŒåŠŸèƒ½æ˜¯ä¸€è‡´çš„ã€‚åœ¨<code>tf_demo</code>æ•™å­¦åŒ…å½“ä¸­çš„<code>scripts/py_tf_broadcaster.py</code>å’Œ<code>scripts/py_tf_broadcaster02.py</code>ç»™å‡ºäº†ç¤ºä¾‹ç¨‹åºï¼Œè¯¦è§å¦‚ä¸‹ã€‚</p><p>py_tf_broadcaster.py</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python  </span><br><span class="line"># -*- coding:utf-8 -*-  </span><br><span class="line"></span><br><span class="line">import rospy  </span><br><span class="line">import math  </span><br><span class="line">import tf    </span><br><span class="line">if __name__ == &#x27;__main__&#x27;:  </span><br><span class="line">    rospy.init_node(&#x27;py_tf_broadcaster&#x27;)</span><br><span class="line">    print &#x27;è®²è§£tf.transformBroadcasterç±»&#x27;</span><br><span class="line">    print &#x27;ç¬¬1ç§å‘å¸ƒæ–¹å¼ï¼šsendTransform(translation,rotation,time,child,parent)&#x27;</span><br><span class="line">#ç¬¬ä¸€éƒ¨åˆ†ï¼Œå‘å¸ƒsendTransform(translation,rotation,time,child,parent)</span><br><span class="line">    br = tf.TransformBroadcaster()</span><br><span class="line">#è¾“å…¥ç›¸å¯¹åŸç‚¹çš„å€¼å’Œæ¬§æ‹‰è§’</span><br><span class="line">    x=1.0 </span><br><span class="line">    y=2.0</span><br><span class="line">    z=3.0  </span><br><span class="line">    roll=0 </span><br><span class="line">    pitch=0</span><br><span class="line">    yaw=1.57 </span><br><span class="line">    rate = rospy.Rate(1)</span><br><span class="line">    while not rospy.is_shutdown(): </span><br><span class="line">        yaw=yaw+0.1   </span><br><span class="line">        br.sendTransform((x,y,z),  </span><br><span class="line">                     tf.transformations.quaternion_from_euler(roll,pitch,yaw),  </span><br><span class="line">                     rospy.Time.now(),  </span><br><span class="line">                     &quot;base_link&quot;,  </span><br><span class="line">                     &quot;link1&quot;)  #å‘å¸ƒbase_linkåˆ°link1çš„å¹³ç§»å’Œç¿»è½¬   </span><br><span class="line">        rate.sleep()</span><br></pre></td></tr></table></figure><p>py_tf_broadcaster02.py</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python  </span><br><span class="line"># -*- coding:utf-8 -*-  </span><br><span class="line"></span><br><span class="line">import rospy </span><br><span class="line">import geometry_msgs.msg</span><br><span class="line">import tf2_ros.transform_broadcaster</span><br><span class="line">import math  </span><br><span class="line">import tf   </span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:  </span><br><span class="line">    rospy.init_node(&#x27;py_tf_broadcaster&#x27;)</span><br><span class="line">    print &#x27;è®²è§£tf.transformBroadcasterç±»&#x27;</span><br><span class="line">    print &#x27;ç¬¬2ç§å‘å¸ƒæ–¹å¼ï¼šsendTransformMessage(transform)&#x27;</span><br><span class="line">#ç¬¬äºŒéƒ¨åˆ†ï¼Œå‘å¸ƒsendTransformMessage(transform)</span><br><span class="line">    m=tf.TransformBroadcaster()</span><br><span class="line">    t = geometry_msgs.msg.TransformStamped()</span><br><span class="line">    t.header.frame_id = &#x27;base_link&#x27;</span><br><span class="line">    t.header.stamp = rospy.Time(0)</span><br><span class="line">    t.child_frame_id = &#x27;link1&#x27;</span><br><span class="line">    t.transform.translation.x = 1</span><br><span class="line">    t.transform.translation.y = 2</span><br><span class="line">    t.transform.translation.z = 3</span><br><span class="line">    t.transform.rotation.w=1</span><br><span class="line">    t.transform.rotation.x=0</span><br><span class="line">    t.transform.rotation.y=0</span><br><span class="line">    t.transform.rotation.z=0</span><br><span class="line">#è¾“å…¥ç›¸å¯¹åŸç‚¹çš„å€¼å’Œæ¬§æ‹‰è§’</span><br><span class="line">    rate = rospy.Rate(1)</span><br><span class="line">    while not rospy.is_shutdown():</span><br><span class="line">        m.sendTransformMessage(t)</span><br><span class="line">        rate.sleep()</span><br></pre></td></tr></table></figure><h2 id="46-tfç›¸å…³å·¥å…·å‘½ä»¤"><a class="markdownIt-Anchor" href="#46-tfç›¸å…³å·¥å…·å‘½ä»¤"></a> 4.6. TFç›¸å…³å·¥å…·å‘½ä»¤</h2><ol><li><p>æ ¹æ®å½“å‰çš„tfæ ‘åˆ›å»ºä¸€ä¸ªpdfå›¾ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ rosrun tf view_frames</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªå·¥å…·é¦–å…ˆè®¢é˜…<code>/tf</code>ï¼Œè®¢é˜…5ç§’é’Ÿï¼Œæ ¹æ®è¿™æ®µæ—¶é—´æ¥å—åˆ°çš„tfä¿¡æ¯ï¼Œç»˜åˆ¶æˆä¸€å¼ tf treeï¼Œç„¶ååˆ›å»ºæˆä¸€ä¸ªpdfå›¾ã€‚</p></li><li><p>æŸ¥çœ‹å½“å‰çš„tfæ ‘ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ rosrun rqt_tf_tree rqt_tf_tree</span><br></pre></td></tr></table></figure><p>è¯¥å‘½ä»¤åŒæ ·æ˜¯æŸ¥è¯¢tf treeçš„ï¼Œä½†æ˜¯ä¸ç¬¬ä¸€ä¸ªå‘½ä»¤çš„åŒºåˆ«æ˜¯è¯¥å‘½ä»¤æ˜¯åŠ¨æ€çš„æŸ¥è¯¢å½“å‰çš„tf tree,å½“å‰çš„ä»»ä½•å˜åŒ–éƒ½èƒ½å½“å³çœ‹åˆ°ï¼Œä¾‹å¦‚ä½•æ—¶æ–­å¼€ä½•æ—¶è¿æ¥ï¼Œæ•æ‰åˆ°è¿™äº›ç„¶åé€šè¿‡rqtæ’ä»¶æ˜¾ç¤ºå‡ºæ¥ã€‚</p></li><li><p>æŸ¥çœ‹ä¸¤ä¸ªframeä¹‹é—´çš„å˜æ¢å…³ç³»ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ rosrun tf tf_echo[reference_frame][target_frame]</span><br></pre></td></tr></table></figure></li></ol><h1 id="5-tf-in-python"><a class="markdownIt-Anchor" href="#5-tf-in-python"></a> 5. tf in python</h1><h2 id="51-ç®€ä»‹"><a class="markdownIt-Anchor" href="#51-ç®€ä»‹"></a> 5.1. ç®€ä»‹</h2><p>æˆ‘ä»¬çŸ¥é“tfä¸­ä¸ä»…æœ‰C<ins>çš„æ¥å£ï¼Œä¹Ÿæœ‰Pythonçš„æ¥å£ã€‚ç›¸æ¯”C</ins>ï¼Œtfåœ¨Pythonä¸­çš„å…·ä½“å®ç°ç›¸å¯¹ç®€å•å¥½ç”¨ã€‚</p><h2 id="52-æ•°æ®ç±»å‹"><a class="markdownIt-Anchor" href="#52-æ•°æ®ç±»å‹"></a> 5.2. æ•°æ®ç±»å‹</h2><p>TFçš„ç›¸å…³æ•°æ®ç±»å‹ï¼Œå‘é‡ã€ç‚¹ã€å››å…ƒæ•°ã€çŸ©é˜µéƒ½å¯ä»¥è¡¨ç¤ºæˆç±»ä¼¼æ•°ç»„å½¢å¼ï¼Œå°±æ˜¯å®ƒä»¬éƒ½å¯ä»¥ç”¨Tupleï¼ŒListï¼ŒNumpy Arrayæ¥è¡¨ç¤ºã€‚<br>ä¾‹å¦‚ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">t = (1.0,1.5,0) #å¹³ç§»</span><br><span class="line">q = [1,0,0,0] #å››å…ƒæ•°</span><br><span class="line">m = numpy.identity(3) #æ—‹è½¬çŸ©é˜µ</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€ä¸ªå¹³ç§»æ•°æ®ä½¿ç”¨Tupleè¡¨ç¤ºçš„ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥ç”¨Listè¡¨ç¤ºæˆt=[1.0,1.5,0],ä¹Ÿèƒ½ç”¨numpy.array(1.0,1.5,0)æ¥è¡¨ç¤ºéƒ½æ˜¯å¯ä»¥çš„ã€‚è¿™äº›æ•°æ®ç±»å‹æ²¡æœ‰ç‰¹æ®Šå¯¹åº”ï¼Œå…¨éƒ¨æ˜¯é€šç”¨çš„ï¼Œæ‰€ä»¥è¿™é‡Œä¹Ÿå°±æ²¡æœ‰äº†å„ç§æ•°æ®ç±»å‹çš„è½¬æ¢çš„éº»çƒ¦ã€‚</p><h2 id="53-tfåº“"><a class="markdownIt-Anchor" href="#53-tfåº“"></a> 5.3. TFåº“</h2><h3 id="531-tftransformations"><a class="markdownIt-Anchor" href="#531-tftransformations"></a> 5.3.1. tf.transformations</h3><p>åŸºæœ¬æ•°å­¦è¿ç®—å‡½æ•°</p><table><thead><tr><th style="text-align:center">å‡½æ•°</th><th style="text-align:center">æ³¨é‡Š</th></tr></thead><tbody><tr><td style="text-align:center">euler_matrix(ai,aj,ak,axes=â€˜sxyzâ€™)</td><td style="text-align:center">æ¬§æ‹‰è§’åˆ°çŸ©é˜µ</td></tr><tr><td style="text-align:center">eulaer_form_matrix(matrix,axes=â€˜sxyzâ€™)</td><td style="text-align:center">çŸ©é˜µåˆ°æ¬§æ‹‰è§’</td></tr><tr><td style="text-align:center">eular_from_quaternion(quaternion,axes=â€˜sxyzâ€™)</td><td style="text-align:center">å››å…ƒæ•°åˆ°æ¬§æ‹‰è§’</td></tr><tr><td style="text-align:center">quaternion_form_euler(ai,aj,ak,axes=â€˜sxyzâ€™)</td><td style="text-align:center">æ¬§æ‹‰è§’åˆ°å››å…ƒæ•°</td></tr><tr><td style="text-align:center">quaternion_matrix(quaternion)</td><td style="text-align:center">å››å…ƒæ•°åˆ°çŸ©é˜µ</td></tr><tr><td style="text-align:center">quaternion_form_matrix(matrix)</td><td style="text-align:center">çŸ©é˜µåˆ°å››å…ƒæ•°</td></tr><tr><td style="text-align:center">â€¦</td><td style="text-align:center">â€¦</td></tr></tbody></table><p>ä½¿ç”¨è¯¥å‡½æ•°åº“æ—¶å€™ï¼Œé¦–å…ˆ<code>import tf</code>ï¼Œtf.transformationsç»™æˆ‘ä»¬æä¾›äº†ä¸€äº›åŸºæœ¬çš„æ•°å­¦è¿ç®—å‡½æ•°å¦‚ä¸Šï¼Œä½¿ç”¨èµ·æ¥éå¸¸æ–¹ä¾¿ã€‚åœ¨tf_demoä¸­æ•™å­¦åŒ…å½“ä¸­ï¼Œæˆ‘ä»¬åˆ—ä¸¾äº†ä¸€äº›tf.transformationså¸¸è§çš„APIå’Œç¤ºä¾‹ä»£ç ï¼Œå…·è¯¦è§ä¸‹è¡¨ã€‚</p><h3 id="532-ç¬¬1éƒ¨åˆ†å®šä¹‰ç©ºé—´ç‚¹å’Œç©ºé—´å‘é‡"><a class="markdownIt-Anchor" href="#532-ç¬¬1éƒ¨åˆ†å®šä¹‰ç©ºé—´ç‚¹å’Œç©ºé—´å‘é‡"></a> 5.3.2. ç¬¬1éƒ¨åˆ†ï¼Œå®šä¹‰ç©ºé—´ç‚¹å’Œç©ºé—´å‘é‡</h3><table><thead><tr><th style="text-align:center">ç¼–å·</th><th style="text-align:center">å‡½æ•°åç§°</th><th style="text-align:center">å‡½æ•°åŠŸèƒ½</th></tr></thead><tbody><tr><td style="text-align:center">1.1</td><td style="text-align:center">tf.transformations.random_quaternion(rand=None)</td><td style="text-align:center">è¿”å›å‡åŒ€éšæœºå•ä½å››å…ƒæ•°</td></tr><tr><td style="text-align:center">1.2</td><td style="text-align:center">tf.transformations.random_rotation_matrix(rand=None)</td><td style="text-align:center">è¿”å›å‡åŒ€éšæœºå•ä½æ—‹è½¬çŸ©é˜µ</td></tr><tr><td style="text-align:center">1.3</td><td style="text-align:center">tf.transformations.random_vector(size)</td><td style="text-align:center">è¿”å›å‡åŒ€éšæœºå•ä½å‘é‡</td></tr><tr><td style="text-align:center">1.4</td><td style="text-align:center">tf.transformations.translation_matrix(v)</td><td style="text-align:center">é€šè¿‡å‘é‡æ¥æ±‚æ—‹è½¬çŸ©é˜µ</td></tr><tr><td style="text-align:center">1.5</td><td style="text-align:center">tf.transformations.translation_from_matrix(m)</td><td style="text-align:center">é€šè¿‡æ—‹è½¬çŸ©é˜µæ¥æ±‚å‘é‡</td></tr></tbody></table><h3 id="533-ç¬¬2éƒ¨åˆ†å®šä¹‰å››å…ƒæ•°"><a class="markdownIt-Anchor" href="#533-ç¬¬2éƒ¨åˆ†å®šä¹‰å››å…ƒæ•°"></a> 5.3.3. ç¬¬2éƒ¨åˆ†ï¼Œå®šä¹‰å››å…ƒæ•°</h3><table><thead><tr><th style="text-align:center">ç¼–å·</th><th style="text-align:center">å‡½æ•°åç§°</th><th style="text-align:center">å‡½æ•°åŠŸèƒ½</th></tr></thead><tbody><tr><td style="text-align:center">2.1</td><td style="text-align:center">tf.transformations.quaternion_about_axis(angle axis)</td><td style="text-align:center">é€šè¿‡æ—‹è½¬è½´å’Œæ—‹è½¬è§’è¿”å›å››å…ƒæ•°</td></tr><tr><td style="text-align:center">2.2</td><td style="text-align:center">tf.transformations.quaternion_conjugate(quaternion)</td><td style="text-align:center">è¿”å›å››å…ƒæ•°çš„å…±è½­</td></tr><tr><td style="text-align:center">2.3</td><td style="text-align:center">tf.transformations.quaternion_from_euler(ai,aj,ak, axesâ€™ryxzâ€™)</td><td style="text-align:center">ä»æ¬§æ‹‰è§’å’Œæ—‹è½¬è½´ï¼Œæ±‚å››å…ƒæ•°</td></tr><tr><td style="text-align:center">2.4</td><td style="text-align:center">tf.transformations.quaternion_from_matrix(matrix)</td><td style="text-align:center">ä»æ—‹è½¬çŸ©é˜µä¸­ï¼Œè¿”å›å››å…ƒæ•°</td></tr><tr><td style="text-align:center">2.5</td><td style="text-align:center">tf.transformations.quaternion_multiply(quaternion1,quaternion2)</td><td style="text-align:center">ä¸¤ä¸ªå››å…ƒæ•°ç›¸ä¹˜</td></tr></tbody></table><h3 id="534-ç¬¬3éƒ¨åˆ†å®šä¹‰å››å…ƒæ•°"><a class="markdownIt-Anchor" href="#534-ç¬¬3éƒ¨åˆ†å®šä¹‰å››å…ƒæ•°"></a> 5.3.4. ç¬¬3éƒ¨åˆ†ï¼Œå®šä¹‰å››å…ƒæ•°</h3><table><thead><tr><th style="text-align:center">ç¼–å·</th><th style="text-align:center">å‡½æ•°åç§°</th><th style="text-align:center">å‡½æ•°åŠŸèƒ½</th></tr></thead><tbody><tr><td style="text-align:center">3.1</td><td style="text-align:center">tf.transformations.euler_matrix(ai,aj,ak,axes=â€˜xyzâ€™)</td><td style="text-align:center">ç”±æ¬§æ‹‰è§’å’Œæ—‹è½¬è½´è¿”å›æ—‹è½¬çŸ©é˜µ</td></tr><tr><td style="text-align:center">3.2</td><td style="text-align:center">tf.transformations.euler_from_matrix(matrix)</td><td style="text-align:center">ç”±æ—‹è½¬çŸ©é˜µå’Œç‰¹å®šçš„æ—‹è½¬è½´è¿”å›æ¬§æ‹‰è§’</td></tr><tr><td style="text-align:center">3.3</td><td style="text-align:center">tf.transformations.euler_from_quaternion(quaternion)</td><td style="text-align:center">ç”±å››å…ƒæ•°å’Œç‰¹å®šçš„è½´å¾—åˆ°æ¬§æ‹‰è§’</td></tr></tbody></table><p>ç¤ºä¾‹ä»£ç ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python  </span><br><span class="line"># -*- coding:utf-8 -*-  </span><br><span class="line">import rospy  </span><br><span class="line">import math  </span><br><span class="line">import tf  </span><br><span class="line">if __name__ == &#x27;__main__&#x27;:  </span><br><span class="line">    rospy.init_node(&#x27;py_coordinate_transformation&#x27;)</span><br><span class="line">#ç¬¬1éƒ¨åˆ†ï¼Œå®šä¹‰ç©ºé—´ç‚¹å’Œç©ºé—´å‘é‡</span><br><span class="line">    print &#x27;ç¬¬1éƒ¨åˆ†ï¼Œå®šä¹‰ç©ºé—´ç‚¹å’Œç©ºé—´å‘é‡&#x27;</span><br><span class="line">#1.1 è¿”å›å‡åŒ€éšæœºå•ä½å››å…ƒæ•°</span><br><span class="line">    q=tf.transformations.random_quaternion(rand=None)</span><br><span class="line">    print &#x27;å®šä¹‰å‡åŒ€éšæœºå››å…ƒæ•°ï¼š&#x27;</span><br><span class="line">    print q</span><br><span class="line">#1.2 è¿”å›å‡åŒ€éšæœºå•ä½æ—‹è½¬çŸ©é˜µ</span><br><span class="line">    m=tf.transformations.random_rotation_matrix(rand=None)</span><br><span class="line">    print &#x27;å®šä¹‰å‡åŒ€éšæœºå•ä½æ—‹è½¬çŸ©é˜µï¼š&#x27;</span><br><span class="line">    print m</span><br><span class="line">#1.3 è¿”å›å‡åŒ€éšæœºå•ä½å‘é‡</span><br><span class="line">    v=tf.transformations.random_vector(3)</span><br><span class="line">    print &#x27;å®šä¹‰å‡åŒ€éšæœºå•ä½å‘é‡ï¼š&#x27;</span><br><span class="line">    print v</span><br><span class="line">#1.4 é€šè¿‡å‘é‡æ¥æ±‚æ—‹è½¬çŸ©é˜µ</span><br><span class="line">    v_m=tf.transformations.translation_matrix(v)</span><br><span class="line">    print &#x27;é€šè¿‡å‘é‡æ¥æ±‚æ—‹è½¬çŸ©é˜µï¼š&#x27;</span><br><span class="line">    print v_m</span><br><span class="line">#1.5 é€šè¿‡æ—‹è½¬çŸ©é˜µæ¥æ±‚å‘é‡</span><br><span class="line">    m_v=tf.transformations.translation_from_matrix(m)</span><br><span class="line">    print &#x27;é€šè¿‡æ—‹è½¬çŸ©é˜µæ¥æ±‚å‘é‡ï¼š&#x27;</span><br><span class="line">    print  m_v</span><br><span class="line">#ç¬¬2éƒ¨åˆ†ï¼Œå®šä¹‰å››å…ƒæ•°</span><br><span class="line">    print &#x27;ç¬¬2éƒ¨åˆ†ï¼Œå®šä¹‰å››å…ƒæ•°&#x27;</span><br><span class="line">#2.1 é€šè¿‡æ—‹è½¬è½´å’Œæ—‹è½¬è§’è¿”å›å››å…ƒæ•°</span><br><span class="line">    axis_q=tf.transformations.quaternion_about_axis(0.123, (1, 0, 0))</span><br><span class="line">    print &#x27;é€šè¿‡æ—‹è½¬è½´å’Œæ—‹è½¬è§’è¿”å›å››å…ƒæ•°ï¼š&#x27;</span><br><span class="line">    print  axis_q</span><br><span class="line">#2.2 è¿”å›å››å…ƒæ•°çš„å…±è½­</span><br><span class="line">    n_q=tf.transformations.quaternion_conjugate(q)</span><br><span class="line">    print &#x27;è¿”å›å››å…ƒæ•°qçš„å…±è½­ï¼š&#x27;</span><br><span class="line">    print  n_q</span><br><span class="line">#2.3 ä»æ¬§æ‹‰è§’å’Œæ—‹è½¬è½´ï¼Œæ±‚å››å…ƒæ•°</span><br><span class="line">    o_q=tf.transformations.quaternion_from_euler(1, 2, 3, &#x27;ryxz&#x27;)</span><br><span class="line">    print &#x27;ä»æ¬§æ‹‰è§’å’Œæ—‹è½¬è½´ï¼Œæ±‚å››å…ƒæ•°ï¼š&#x27;</span><br><span class="line">    print  o_q    </span><br><span class="line">#2.4 ä»æ—‹è½¬çŸ©é˜µä¸­ï¼Œè¿”å›å››å…ƒæ•°</span><br><span class="line">    m_q=tf.transformations.quaternion_from_matrix(m)</span><br><span class="line">    print &#x27;ä»æ—‹è½¬çŸ©é˜µä¸­ï¼Œè¿”å›å››å…ƒæ•°ï¼š&#x27;</span><br><span class="line">    print  m_q </span><br><span class="line">#2.5 ä¸¤ä¸ªå››å…ƒæ•°ç›¸ä¹˜</span><br><span class="line">    qxq=tf.transformations.quaternion_multiply(q,n_q)</span><br><span class="line">    print &#x27;ä¸¤ä¸ªå››å…ƒæ•°ç›¸ä¹˜&#x27;</span><br><span class="line">    print  qxq   </span><br><span class="line">`</span><br></pre></td></tr></table></figure><h2 id="54-tfç±»"><a class="markdownIt-Anchor" href="#54-tfç±»"></a> 5.4. TFç±»</h2><h3 id="541-tftransformlistenerç±»"><a class="markdownIt-Anchor" href="#541-tftransformlistenerç±»"></a> 5.4.1. tf.TransformListenerç±»</h3><table><thead><tr><th style="text-align:center">æ–¹æ³•</th><th style="text-align:center">ä½œç”¨</th></tr></thead><tbody><tr><td style="text-align:center">canTransform(self,target_frame,source_frame,time)</td><td style="text-align:center">frameæ˜¯å¦ç›¸é€š</td></tr><tr><td style="text-align:center">waitForTransform(self,target_frame,source_frame,time,timeout)</td><td style="text-align:center">é˜»å¡ç›´åˆ°frameç›¸é€š</td></tr><tr><td style="text-align:center">lookup Transform(self,target_frame,source_frame,time)</td><td style="text-align:center">æŸ¥çœ‹ç›¸å¯¹çš„tfï¼Œè¿”å›ï¼ˆtransï¼Œquatï¼‰</td></tr></tbody></table><p>tf.TransformListenerç±»ä¸­ä¸»è¦åŒ…å«ä»¥ä¸Šä¸‰ç§æ–¹æ³•ï¼Œå®ƒçš„æ„é€ å‡½æ•°ä¸éœ€è¦å¡«å€¼ã€‚æ³¨æ„è¿™é‡Œçš„timeå‚æ•°ï¼Œä¾ç„¶æ˜¯ä½¿ç”¨<code>rospy.Time(0)</code>è€Œä¸æ˜¯<code>rospy.Time.now()</code>.å…·ä½“åŸå› ä¸ŠèŠ‚å·²ç»ä»‹ç»ï¼Œè¿™é‡Œä¸å†èµ˜è¿°ã€‚é™¤äº†ä¸Šè¿°ä¸‰ç§é‡è¦çš„æ–¹æ³•ï¼Œè¿™ä¸ªç±»ä¸­è¿˜æœ‰ä¸€äº›è¾…åŠ©ç”¨çš„æ–¹æ³•å¦‚ä¸‹ï¼š</p><table><thead><tr><th style="text-align:center">æ–¹æ³•</th><th style="text-align:center">ä½œç”¨</th></tr></thead><tbody><tr><td style="text-align:center">chain(target_frame,target_time,source_frame,source_time,fixed_frame)</td><td style="text-align:center">frameçš„è¿æ¥å…³ç³»</td></tr><tr><td style="text-align:center">frameExists(self,frame_id)</td><td style="text-align:center">frameæ˜¯å¦å­˜åœ¨</td></tr><tr><td style="text-align:center">getFrameStrings(self)</td><td style="text-align:center">è¿”å›æ‰€æœ‰tfçš„åç§°</td></tr><tr><td style="text-align:center">fromTranslationRotation(translation,rotation)</td><td style="text-align:center">æ ¹æ®å¹³ç§»å’Œæ—‹è½¬è¿”å›4X4çŸ©é˜µ</td></tr><tr><td style="text-align:center">transformPoint(target_frame,point_msg)</td><td style="text-align:center">å°†PointStampedæ¶ˆæ¯è½¬æ¢åˆ°æ–°frameä¸‹</td></tr><tr><td style="text-align:center">transformPose(target_frame,pose_msg)</td><td style="text-align:center">å°†PoseStampedæ¶ˆæ¯è½¬æ¢åˆ°æ–°frameä¸‹</td></tr><tr><td style="text-align:center">transformQuaternion(target_frame,quat_msg)</td><td style="text-align:center">å°†QuaternionStampedâ€¦è¿”å›ç›¸åŒç±»å‹</td></tr><tr><td style="text-align:center">â€¦</td><td style="text-align:center">â€¦</td></tr></tbody></table><p>åœ¨<code>tf_demo</code>æ•™å­¦åŒ…å½“ä¸­çš„<code>scripts/py_tf_listerner.py</code>ç»™å‡ºäº†ç¤ºä¾‹ç¨‹åºï¼Œè¯¦è§å¦‚ä¸‹ã€‚</p><p>py_tf_listerner.py</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python  </span><br><span class="line"># -*- coding:utf-8 -*-  </span><br><span class="line">import rospy  </span><br><span class="line">import math  </span><br><span class="line">import tf   </span><br><span class="line">if __name__ == &#x27;__main__&#x27;:  </span><br><span class="line">    rospy.init_node(&#x27;py_tf_turtle&#x27;)</span><br><span class="line">    listener = tf.TransformListener() #TransformListeneråˆ›å»ºåå°±å¼€å§‹æ¥å—tfå¹¿æ’­ä¿¡æ¯ï¼Œæœ€å¤šå¯ä»¥ç¼“å­˜10s  ç›®å‰å­˜åœ¨çš„é—®é¢˜ï¼Œæ˜¯å››ä¸ªæ•°å€¼çš„é¡ºåºæˆ‘è¿˜æœ‰ç‚¹é—®é¢˜</span><br><span class="line">    rate = rospy.Rate(1.0)  </span><br><span class="line">    #1. é˜»å¡ç›´åˆ°frameç›¸é€š</span><br><span class="line">    print &#x27;1. é˜»å¡ç›´åˆ°frameç›¸é€š&#x27;  </span><br><span class="line">    listener.waitForTransform(&quot;/base_link&quot;, &quot;/link1&quot;, rospy.Time(), rospy.Duration(4.0))</span><br><span class="line">    while not rospy.is_shutdown():  </span><br><span class="line">        try:  </span><br><span class="line">        #2. ç›‘å¬å¯¹åº”çš„tf,è¿”å›å¹³ç§»å’Œæ—‹è½¬</span><br><span class="line">            print &#x27;2. ç›‘å¬å¯¹åº”çš„tf,è¿”å›å¹³ç§»å’Œæ—‹è½¬&#x27;  </span><br><span class="line">            (trans,rot) = listener.lookupTransform(&#x27;/base_link&#x27;, &#x27;/link1&#x27;, rospy.Time(0)) #rospy.Time(0)ä¸è¡¨ç¤º0æ—¶åˆ»çš„tfï¼Œè€Œæ˜¯æŒ‡æœ€è¿‘ä¸€å¸§tf </span><br><span class="line">        except (tf.LookupException, tf.ConnectivityException, tf.ExtrapolationException):  </span><br><span class="line">            continue    </span><br><span class="line">        rospy.loginfo(&#x27;è·ç¦»åŸç‚¹çš„ä½ç½®: x=%f ,y= %fï¼Œz=%f \n æ—‹è½¬å››å…ƒæ•°: w=%f ,x= %fï¼Œy=%f z=%f &#x27;,trans[0],trans[1],trans[2],rot[0],rot[1],rot[2],rot[3])</span><br><span class="line">        #3. åˆ¤æ–­ä¸¤ä¸ªframeæ˜¯å¦ç›¸é€š</span><br><span class="line">        print &#x27;3. åˆ¤æ–­ä¸¤ä¸ªframeæ˜¯å¦ç›¸é€š&#x27;</span><br><span class="line">        if listener.canTransform(&#x27;/link1&#x27;,&#x27;/base_link&#x27;,rospy.Time(0)) :</span><br><span class="line">            print &#x27;true&#x27;</span><br><span class="line">        else :</span><br><span class="line">            print &#x27;false&#x27;</span><br><span class="line">        rate.sleep()</span><br></pre></td></tr></table></figure><h3 id="542"><a class="markdownIt-Anchor" href="#542"></a> 5.4.2.</h3><h3 id="543-tftransformbroadcasterç±»"><a class="markdownIt-Anchor" href="#543-tftransformbroadcasterç±»"></a> 5.4.3. tf.TransformBroadcasterç±»</h3><p>ç±»ä¼¼çš„ï¼Œæˆ‘ä»¬ä»‹ç»çš„æ˜¯å‘å¸ƒæ–¹ï¼Œtf.TransformBroadcasterç±»ã€‚è¯¥ç±»çš„æ„é€ å‡½æ•°ä¹Ÿæ˜¯ä¸éœ€è¦å¡«å€¼ï¼Œæˆå‘˜å‡½æ•°æœ‰ä¸¤ä¸ªå¦‚ä¸‹ï¼š</p><ul><li>sendTransform(translation,rotation,time,child,parent)#å‘/tfå‘å¸ƒæ¶ˆæ¯</li><li>sendTransformMessage(transform)#å‘/tfå‘å¸ƒæ¶ˆæ¯</li></ul><p>ç¬¬ä¸€ä¸ªsendTransform()æŠŠtransformçš„å¹³ç§»å’Œæ—‹è½¬å¡«å¥½ï¼Œæ‰“ä¸Šæ—¶é—´æˆ³ï¼Œç„¶åè¡¨ç¤ºå‡ºä»çˆ¶åˆ°å­çš„frameæµï¼Œç„¶åå‘å‘<code>/tf</code>çš„topicã€‚ç¬¬äºŒç§æ˜¯å‘é€transformå·²ç»å°è£…å¥½çš„Messageç»™<code>/tf</code>ï¼Œè¿™ä¸¤ç§ä¸åŒçš„å‘é€æ–¹å¼ï¼ŒåŠŸèƒ½æ˜¯ä¸€è‡´çš„ã€‚åœ¨<code>tf_demo</code>æ•™å­¦åŒ…å½“ä¸­çš„<code>scripts/py_tf_broadcaster.py</code>å’Œ<code>scripts/py_tf_broadcaster02.py</code>ç»™å‡ºäº†ç¤ºä¾‹ç¨‹åºï¼Œè¯¦è§å¦‚ä¸‹ã€‚</p><p>py_tf_broadcaster.py</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python  </span><br><span class="line"># -*- coding:utf-8 -*-  </span><br><span class="line"></span><br><span class="line">import rospy  </span><br><span class="line">import math  </span><br><span class="line">import tf    </span><br><span class="line">if __name__ == &#x27;__main__&#x27;:  </span><br><span class="line">    rospy.init_node(&#x27;py_tf_broadcaster&#x27;)</span><br><span class="line">    print &#x27;è®²è§£tf.transformBroadcasterç±»&#x27;</span><br><span class="line">    print &#x27;ç¬¬1ç§å‘å¸ƒæ–¹å¼ï¼šsendTransform(translation,rotation,time,child,parent)&#x27;</span><br><span class="line">#ç¬¬ä¸€éƒ¨åˆ†ï¼Œå‘å¸ƒsendTransform(translation,rotation,time,child,parent)</span><br><span class="line">    br = tf.TransformBroadcaster()</span><br><span class="line">#è¾“å…¥ç›¸å¯¹åŸç‚¹çš„å€¼å’Œæ¬§æ‹‰è§’</span><br><span class="line">    x=1.0 </span><br><span class="line">    y=2.0</span><br><span class="line">    z=3.0  </span><br><span class="line">    roll=0 </span><br><span class="line">    pitch=0</span><br><span class="line">    yaw=1.57 </span><br><span class="line">    rate = rospy.Rate(1)</span><br><span class="line">    while not rospy.is_shutdown(): </span><br><span class="line">        yaw=yaw+0.1   </span><br><span class="line">        br.sendTransform((x,y,z),  </span><br><span class="line">                     tf.transformations.quaternion_from_euler(roll,pitch,yaw),  </span><br><span class="line">                     rospy.Time.now(),  </span><br><span class="line">                     &quot;base_link&quot;,  </span><br><span class="line">                     &quot;link1&quot;)  #å‘å¸ƒbase_linkåˆ°link1çš„å¹³ç§»å’Œç¿»è½¬   </span><br><span class="line">        rate.sleep()</span><br></pre></td></tr></table></figure><p>py_tf_broadcaster02.py</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python  </span><br><span class="line"># -*- coding:utf-8 -*-  </span><br><span class="line"></span><br><span class="line">import rospy </span><br><span class="line">import geometry_msgs.msg</span><br><span class="line">import tf2_ros.transform_broadcaster</span><br><span class="line">import math  </span><br><span class="line">import tf   </span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:  </span><br><span class="line">    rospy.init_node(&#x27;py_tf_broadcaster&#x27;)</span><br><span class="line">    print &#x27;è®²è§£tf.transformBroadcasterç±»&#x27;</span><br><span class="line">    print &#x27;ç¬¬2ç§å‘å¸ƒæ–¹å¼ï¼šsendTransformMessage(transform)&#x27;</span><br><span class="line">#ç¬¬äºŒéƒ¨åˆ†ï¼Œå‘å¸ƒsendTransformMessage(transform)</span><br><span class="line">    m=tf.TransformBroadcaster()</span><br><span class="line">    t = geometry_msgs.msg.TransformStamped()</span><br><span class="line">    t.header.frame_id = &#x27;base_link&#x27;</span><br><span class="line">    t.header.stamp = rospy.Time(0)</span><br><span class="line">    t.child_frame_id = &#x27;link1&#x27;</span><br><span class="line">    t.transform.translation.x = 1</span><br><span class="line">    t.transform.translation.y = 2</span><br><span class="line">    t.transform.translation.z = 3</span><br><span class="line">    t.transform.rotation.w=1</span><br><span class="line">    t.transform.rotation.x=0</span><br><span class="line">    t.transform.rotation.y=0</span><br><span class="line">    t.transform.rotation.z=0</span><br><span class="line">#è¾“å…¥ç›¸å¯¹åŸç‚¹çš„å€¼å’Œæ¬§æ‹‰è§’</span><br><span class="line">    rate = rospy.Rate(1)</span><br><span class="line">    while not rospy.is_shutdown():</span><br><span class="line">        m.sendTransformMessage(t)</span><br><span class="line">        rate.sleep()</span><br></pre></td></tr></table></figure><h2 id="55-tfç›¸å…³å·¥å…·å‘½ä»¤"><a class="markdownIt-Anchor" href="#55-tfç›¸å…³å·¥å…·å‘½ä»¤"></a> 5.5. TFç›¸å…³å·¥å…·å‘½ä»¤</h2><ol><li><p>æ ¹æ®å½“å‰çš„tfæ ‘åˆ›å»ºä¸€ä¸ªpdfå›¾ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ rosrun tf view_frames</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªå·¥å…·é¦–å…ˆè®¢é˜…<code>/tf</code>ï¼Œè®¢é˜…5ç§’é’Ÿï¼Œæ ¹æ®è¿™æ®µæ—¶é—´æ¥å—åˆ°çš„tfä¿¡æ¯ï¼Œç»˜åˆ¶æˆä¸€å¼ tf treeï¼Œç„¶ååˆ›å»ºæˆä¸€ä¸ªpdfå›¾ã€‚</p></li><li><p>æŸ¥çœ‹å½“å‰çš„tfæ ‘ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ rosrun rqt_tf_tree rqt_tf_tree</span><br></pre></td></tr></table></figure><p>è¯¥å‘½ä»¤åŒæ ·æ˜¯æŸ¥è¯¢tf treeçš„ï¼Œä½†æ˜¯ä¸ç¬¬ä¸€ä¸ªå‘½ä»¤çš„åŒºåˆ«æ˜¯è¯¥å‘½ä»¤æ˜¯åŠ¨æ€çš„æŸ¥è¯¢å½“å‰çš„tf tree,å½“å‰çš„ä»»ä½•å˜åŒ–éƒ½èƒ½å½“å³çœ‹åˆ°ï¼Œä¾‹å¦‚ä½•æ—¶æ–­å¼€ä½•æ—¶è¿æ¥ï¼Œæ•æ‰åˆ°è¿™äº›ç„¶åé€šè¿‡rqtæ’ä»¶æ˜¾ç¤ºå‡ºæ¥ã€‚</p></li><li><p>æŸ¥çœ‹ä¸¤ä¸ªframeä¹‹é—´çš„å˜æ¢å…³ç³»ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ rosrun tf tf_echo[reference_frame][target_frame]</span><br></pre></td></tr></table></figure></li></ol></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">æ–‡ç« ä½œè€…:</span> <span class="post-copyright-info"><a href="mailto:undefined" rel="external nofollow noreferrer">Malloy Yuan</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">æ–‡ç« é“¾æ¥:</span> <span class="post-copyright-info"><a href="https://elec-creator.com/posts/28077269.html">https://elec-creator.com/posts/28077269.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">ç‰ˆæƒå£°æ˜:</span> <span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noreferrer" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="https://elec-creator.com" target="_blank">Malloy Yuan çš„ä¸ªäººåšå®¢</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/ros/">ROS</a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/MCUheart/Hexo-blog-data@1.0.2/image/cover/post-cover/ros-cover.jpg" data-sites="facebook,twitter,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> æ‰“èµ</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/MCUheart/Hexo-blog-data@1.0.2/image/donate/wechat.jpg" rel="external nofollow noreferrer" target="_blank"><img class="post-qr-code-img" src="/img/private/loading-4.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/MCUheart/Hexo-blog-data@1.0.2/image/donate/wechat.jpg" alt="Wechat"></a><div class="post-qr-code-desc">Wechat</div></li><li class="reward-item"><a href="https://cdn.jsdelivr.net/gh/MCUheart/Hexo-blog-data@1.0.2/image/donate/alipay.jpg" rel="external nofollow noreferrer" target="_blank"><img class="post-qr-code-img" src="/img/private/loading-4.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/MCUheart/Hexo-blog-data@1.0.2/image/donate/alipay.jpg" alt="Alipay"></a><div class="post-qr-code-desc">Alipay</div></li></ul></div></div><div class="ads-wrap"><ins class="adsbygoogle" style="display:block" data-ad-format="fluid" data-ad-layout-key="-fb+5w+4e-db+86" data-ad-client="ca-pub-6017375467561303" data-ad-slot="3926580292"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/3b2a603b.html"><img class="prev-cover" src="/img/private/loading-4.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/MCUheart/Hexo-blog-data@1.0.2/image/cover/post-cover/ros-cover.jpg" onerror='onerror=null,src="/img/private/post_img-load-404-1.jpg"' alt="cover of previous post"><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">ROS-roscpp</div></div></a></div><div class="next-post pull-right"><a href="/posts/ac1d9abb.html"><img class="next-cover" src="/img/private/loading-4.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/MCUheart/Hexo-blog-data@1.0.2/image/cover/post-cover/hexo-cover.jpg" onerror='onerror=null,src="/img/private/post_img-load-404-1.jpg"' alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">hexoå®˜æ–¹æ ‡ç­¾æ’ä»¶ä½¿ç”¨</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>ç›¸å…³æ¨è</span></div><div class="relatedPosts-list"><div><a href="/posts/72d3205.html" title="ROS-windowså®‰è£…ROSç¯å¢ƒ"><img class="cover" src="/img/private/loading-4.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/MCUheart/Hexo-blog-data@1.0.2/image/cover/post-cover/ros-cover.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-05-07</div><div class="title">ROS-windowså®‰è£…ROSç¯å¢ƒ</div></div></a></div><div><a href="/posts/15fa7048.html" title="ROS"><img class="cover" src="/img/private/loading-4.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/MCUheart/Hexo-blog-data@1.0.2/image/cover/post-cover/ros-cover.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-03-18</div><div class="title">ROS</div></div></a></div><div><a href="/posts/b74e4547.html" title="ROSå­¦ä¹ è¿‡ç¨‹çš„ç–‘é—®"><img class="cover" src="/img/private/loading-4.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/MCUheart/Hexo-blog-data@1.0.2/image/cover/post-cover/ros-cover.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-07-05</div><div class="title">ROSå­¦ä¹ è¿‡ç¨‹çš„ç–‘é—®</div></div></a></div><div><a href="/posts/59244a47.html" title="ROSå¸¸ç”¨å·¥å…·"><img class="cover" src="/img/private/loading-4.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/MCUheart/Hexo-blog-data@1.0.2/image/cover/post-cover/ros-cover.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-05-03</div><div class="title">ROSå¸¸ç”¨å·¥å…·</div></div></a></div><div><a href="/posts/894a0bcb.html" title="ROSå¸¸ç”¨æŒ‡ä»¤æ•´ç†"><img class="cover" src="/img/private/loading-4.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/MCUheart/Hexo-blog-data@1.0.2/image/cover/post-cover/ros-cover.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-07-05</div><div class="title">ROSå¸¸ç”¨æŒ‡ä»¤æ•´ç†</div></div></a></div><div><a href="/posts/3b2a603b.html" title="ROS-roscpp"><img class="cover" src="/img/private/loading-4.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/MCUheart/Hexo-blog-data@1.0.2/image/cover/post-cover/ros-cover.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-04-28</div><div class="title">ROS-roscpp</div></div></a></div></div></div><hr><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i> <span>è¯„è®º</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/private/loading-4.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/MCUheart/Hexo-blog-data@1.0.2/image/portrait/portrait-3.jpg" onerror='this.onerror=null,this.src="/img/private/site_img-load-404-1.gif"' alt="avatar"></div><div class="author-info__name">Malloy Yuan</div><div class="author-info__description">__åœ¨æ€»ç»“ä¸­å‰è¿›,åœ¨åæ€ä¸­æå‡__ä¸ªäººå­¦ä¹ /ç»å†/æ„Ÿæ‚Ÿ/é¡¹ç›®ç»éªŒ/ç”Ÿæ´» ç‚¹æ»´çš„è®°å½•ä¸åˆ†äº«</div></div><div class="card-info-data is-center"><div class="card-info-data-item"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">54</div></a></div><div class="card-info-data-item"><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">34</div></a></div><div class="card-info-data-item"><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">37</div></a></div></div><div class="card-info-social-icons is-center"><a class="social-icon" href="http://wpa.qq.com/msgrd?v=3&amp;uin=980298390&amp;site=qq&amp;menu=yes" rel="external nofollow noreferrer" target="_blank" title="QQ"><i class="fab fa-qq"></i></a><a class="social-icon" href="https://weibo.com/u/6622047516" rel="external nofollow noreferrer" target="_blank" title="Weibo"><i class="fab fa-weibo"></i></a><a class="social-icon" href="https://www.zhihu.com/people/yyyml" rel="external nofollow noreferrer" target="_blank" title="Zhihu"><i class="fab fa-zhihu"></i></a><a class="social-icon" href="https://music.163.com/#/user/home?id=19122520" rel="external nofollow noreferrer" target="_blank" title="Neteasy music"><i class="iconfont icon-wangyiyunyinyuemusic1193417easyiconnet"></i></a><a class="social-icon" href="https://space.bilibili.com/432676565" rel="external nofollow noreferrer" target="_blank" title="bilibili"><i class="iconfont icon-bilibili-fill"></i></a><a class="social-icon" href="mailto:yuanml0807@foxmail.com" rel="external nofollow noreferrer" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="/atom.xml" target="_blank" title="RSS"><i class="fas fa-rss"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>å…¬å‘Š</span></div><div class="announcement_content">ä¸å®šæ—¶æ›´çš„ä¸ªäººåšå®¢,å–œæ¬¢è®°å¾—æ”¶è—,æ¬¢è¿æ²Ÿé€šäº¤æµ</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1-%E8%AE%A4%E8%AF%86tf"><span class="toc-text">1. è®¤è¯†TF</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#11-%E7%AE%80%E4%BB%8B"><span class="toc-text">1.1. ç®€ä»‹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-ros%E4%B8%AD%E7%9A%84tf"><span class="toc-text">1.2. ROSä¸­çš„TF</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-tf%E6%B6%88%E6%81%AF"><span class="toc-text">2. TFæ¶ˆæ¯</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#21-transformstampedmsg"><span class="toc-text">2.1. TransformStamped.msg</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#22-%E6%A0%BC%E5%BC%8F%E8%A7%84%E8%8C%83"><span class="toc-text">2.2. æ ¼å¼è§„èŒƒ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#23-tf%E6%A0%91%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-text">2.3. TFæ ‘çš„æ•°æ®ç±»å‹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#24-%E6%A0%BC%E5%BC%8F%E5%AE%9A%E4%B9%89"><span class="toc-text">2.4. æ ¼å¼å®šä¹‰</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-tf-in-c"><span class="toc-text">3. tf in c++</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#31-%E7%AE%80%E4%BB%8B"><span class="toc-text">3.1. ç®€ä»‹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#32-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-text">3.2. æ•°æ®ç±»å‹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#33-%E6%95%B0%E6%8D%AE%E8%BD%AC%E6%8D%A2"><span class="toc-text">3.3. æ•°æ®è½¬æ¢</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#34-%E7%AC%AC1%E9%83%A8%E5%88%86%E5%AE%9A%E4%B9%89%E7%A9%BA%E9%97%B4%E7%82%B9%E5%92%8C%E7%A9%BA%E9%97%B4%E5%90%91%E9%87%8F"><span class="toc-text">3.4. ç¬¬1éƒ¨åˆ†å®šä¹‰ç©ºé—´ç‚¹å’Œç©ºé—´å‘é‡</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#35-%E7%AC%AC2%E9%83%A8%E5%88%86%E5%AE%9A%E4%B9%89%E5%9B%9B%E5%85%83%E6%95%B0"><span class="toc-text">3.5. ç¬¬2éƒ¨åˆ†å®šä¹‰å››å…ƒæ•°</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#36-%E7%AC%AC3%E9%83%A8%E5%88%86%E5%AE%9A%E4%B9%89%E6%97%8B%E8%BD%AC%E7%9F%A9%E9%98%B5"><span class="toc-text">3.6. ç¬¬3éƒ¨åˆ†å®šä¹‰æ—‹è½¬çŸ©é˜µ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#37-tf%E7%B1%BB"><span class="toc-text">3.7. TFç±»</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#38-tftransformbroadcaster%E7%B1%BB"><span class="toc-text">3.8. tf::TransformBroadcasterç±»</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#39-tftransformlistener%E7%B1%BB"><span class="toc-text">3.9. tf::TransformListenerç±»</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4-tf-in-python"><span class="toc-text">4. tf in python</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#41-%E7%AE%80%E4%BB%8B"><span class="toc-text">4.1. ç®€ä»‹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#42-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-text">4.2. æ•°æ®ç±»å‹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#43-%E5%BA%93"><span class="toc-text">4.3. åº“</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#44-tftransformations"><span class="toc-text">4.4. tf.transformations</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#441-%E7%AC%AC1%E9%83%A8%E5%88%86%E5%AE%9A%E4%B9%89%E7%A9%BA%E9%97%B4%E7%82%B9%E5%92%8C%E7%A9%BA%E9%97%B4%E5%90%91%E9%87%8F"><span class="toc-text">4.4.1. ç¬¬1éƒ¨åˆ†ï¼Œå®šä¹‰ç©ºé—´ç‚¹å’Œç©ºé—´å‘é‡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#442-%E7%AC%AC2%E9%83%A8%E5%88%86%E5%AE%9A%E4%B9%89%E5%9B%9B%E5%85%83%E6%95%B0"><span class="toc-text">4.4.2. ç¬¬2éƒ¨åˆ†ï¼Œå®šä¹‰å››å…ƒæ•°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#443-%E7%AC%AC3%E9%83%A8%E5%88%86%E5%AE%9A%E4%B9%89%E5%9B%9B%E5%85%83%E6%95%B0"><span class="toc-text">4.4.3. ç¬¬3éƒ¨åˆ†ï¼Œå®šä¹‰å››å…ƒæ•°</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#45-tf%E7%B1%BB"><span class="toc-text">4.5. TFç±»</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#451-tftransformlistener%E7%B1%BB"><span class="toc-text">4.5.1. tf.TransformListenerç±»</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#452"><span class="toc-text">4.5.2.</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#453-tftransformbroadcaster%E7%B1%BB"><span class="toc-text">4.5.3. tf.TransformBroadcasterç±»</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#46-tf%E7%9B%B8%E5%85%B3%E5%B7%A5%E5%85%B7%E5%91%BD%E4%BB%A4"><span class="toc-text">4.6. TFç›¸å…³å·¥å…·å‘½ä»¤</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#5-tf-in-python"><span class="toc-text">5. tf in python</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#51-%E7%AE%80%E4%BB%8B"><span class="toc-text">5.1. ç®€ä»‹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#52-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-text">5.2. æ•°æ®ç±»å‹</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#53-tf%E5%BA%93"><span class="toc-text">5.3. TFåº“</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#531-tftransformations"><span class="toc-text">5.3.1. tf.transformations</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#532-%E7%AC%AC1%E9%83%A8%E5%88%86%E5%AE%9A%E4%B9%89%E7%A9%BA%E9%97%B4%E7%82%B9%E5%92%8C%E7%A9%BA%E9%97%B4%E5%90%91%E9%87%8F"><span class="toc-text">5.3.2. ç¬¬1éƒ¨åˆ†ï¼Œå®šä¹‰ç©ºé—´ç‚¹å’Œç©ºé—´å‘é‡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#533-%E7%AC%AC2%E9%83%A8%E5%88%86%E5%AE%9A%E4%B9%89%E5%9B%9B%E5%85%83%E6%95%B0"><span class="toc-text">5.3.3. ç¬¬2éƒ¨åˆ†ï¼Œå®šä¹‰å››å…ƒæ•°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#534-%E7%AC%AC3%E9%83%A8%E5%88%86%E5%AE%9A%E4%B9%89%E5%9B%9B%E5%85%83%E6%95%B0"><span class="toc-text">5.3.4. ç¬¬3éƒ¨åˆ†ï¼Œå®šä¹‰å››å…ƒæ•°</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#54-tf%E7%B1%BB"><span class="toc-text">5.4. TFç±»</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#541-tftransformlistener%E7%B1%BB"><span class="toc-text">5.4.1. tf.TransformListenerç±»</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#542"><span class="toc-text">5.4.2.</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#543-tftransformbroadcaster%E7%B1%BB"><span class="toc-text">5.4.3. tf.TransformBroadcasterç±»</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#55-tf%E7%9B%B8%E5%85%B3%E5%B7%A5%E5%85%B7%E5%91%BD%E4%BB%A4"><span class="toc-text">5.5. TFç›¸å…³å·¥å…·å‘½ä»¤</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/a8c481ea.html" title="æ€»ç»“åŸºç¡€çŸ¥è¯†ç‚¹é¢(ä¸€) å•ç‰‡æœºç¯‡"><img src="/img/private/loading-4.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/MCUheart/Hexo-blog-data@1.0.2/image/cover/post-cover/summarization-cover.jpg" onerror='this.onerror=null,this.src="/img/private/post_img-load-404-1.jpg"' alt="æ€»ç»“åŸºç¡€çŸ¥è¯†ç‚¹é¢(ä¸€) å•ç‰‡æœºç¯‡"></a><div class="content"><a class="title" href="/posts/a8c481ea.html" title="æ€»ç»“åŸºç¡€çŸ¥è¯†ç‚¹é¢(ä¸€) å•ç‰‡æœºç¯‡">æ€»ç»“åŸºç¡€çŸ¥è¯†ç‚¹é¢(ä¸€) å•ç‰‡æœºç¯‡</a><time datetime="2020-08-08T16:55:00.000Z" title="å‘è¡¨äº 2020-08-09 00:55:00">2020-08-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/3a13bccb.html" title="C++ arrayæ¨¡æ¿ç±»ä½¿ç”¨"><img src="/img/private/loading-4.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/MCUheart/Hexo-blog-data@1.0.2/image/cover/post-cover/c++-cover.jpg" onerror='this.onerror=null,this.src="/img/private/post_img-load-404-1.jpg"' alt="C++ arrayæ¨¡æ¿ç±»ä½¿ç”¨"></a><div class="content"><a class="title" href="/posts/3a13bccb.html" title="C++ arrayæ¨¡æ¿ç±»ä½¿ç”¨">C++ arrayæ¨¡æ¿ç±»ä½¿ç”¨</a><time datetime="2020-07-24T14:52:40.000Z" title="å‘è¡¨äº 2020-07-24 22:52:40">2020-07-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/925153f2.html" title="C++ ä»£ç æ¢è¡Œçš„é—®é¢˜"><img src="/img/private/loading-4.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/MCUheart/Hexo-blog-data@1.0.2/image/cover/post-cover/c++-cover.jpg" onerror='this.onerror=null,this.src="/img/private/post_img-load-404-1.jpg"' alt="C++ ä»£ç æ¢è¡Œçš„é—®é¢˜"></a><div class="content"><a class="title" href="/posts/925153f2.html" title="C++ ä»£ç æ¢è¡Œçš„é—®é¢˜">C++ ä»£ç æ¢è¡Œçš„é—®é¢˜</a><time datetime="2020-07-24T14:24:40.000Z" title="å‘è¡¨äº 2020-07-24 22:24:40">2020-07-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/dd9d548b.html" title="C++ å¯¹æ•°ç»„è¿›è¡Œå¤åˆ¶"><img src="/img/private/loading-4.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/MCUheart/Hexo-blog-data@1.0.2/image/cover/post-cover/c++-cover.jpg" onerror='this.onerror=null,this.src="/img/private/post_img-load-404-1.jpg"' alt="C++ å¯¹æ•°ç»„è¿›è¡Œå¤åˆ¶"></a><div class="content"><a class="title" href="/posts/dd9d548b.html" title="C++ å¯¹æ•°ç»„è¿›è¡Œå¤åˆ¶">C++ å¯¹æ•°ç»„è¿›è¡Œå¤åˆ¶</a><time datetime="2020-07-24T14:20:40.000Z" title="å‘è¡¨äº 2020-07-24 22:20:40">2020-07-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/4858c62f.html" title="C++ vectorçš„ç”¨æ³•"><img src="/img/private/loading-4.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/MCUheart/Hexo-blog-data@1.0.2/image/cover/post-cover/c++-cover.jpg" onerror='this.onerror=null,this.src="/img/private/post_img-load-404-1.jpg"' alt="C++ vectorçš„ç”¨æ³•"></a><div class="content"><a class="title" href="/posts/4858c62f.html" title="C++ vectorçš„ç”¨æ³•">C++ vectorçš„ç”¨æ³•</a><time datetime="2020-07-24T14:12:40.000Z" title="å‘è¡¨äº 2020-07-24 22:12:40">2020-07-24</time></div></div></div></div><div class="card-widget ads-wrap"><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-6017375467561303" data-ad-slot="4346183088" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div></div></div></main><footer id="footer" style="background-image:url(https://cdn.jsdelivr.net/gh/MCUheart/Hexo-blog-data@1.0.2/image/top/post-top/ros-top.jpg)"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022<i style="color:#ff6a6a" class="fa fa-heartbeat"></i>Malloy Yuan</div><div class="footer_custom_text"><a target="_blank" rel="noopener external nofollow noreferrer" href="http://www.beian.miit.gov.cn"><img class="icp-icon" src="/img/private/loading-4.gif" data-lazy-src="/img/private/icp.png"><span>æ¹˜ICPå¤‡20005957å·</span></a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="ç®€ç¹è½¬æ¢">ç¹</button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="ç›´è¾¾è¯„è®º"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">æœ¬åœ°æœç´¢</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i> <span>æ•°æ®åº“åŠ è½½ä¸­</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"></div></div><hr><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script>function panguFn(){"object"==typeof pangu?pangu.autoSpacingPage():getScript("https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js").then(()=>{pangu.autoSpacingPage()})}function panguInit(){panguFn()}document.addEventListener("DOMContentLoaded",panguInit)</script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>(()=>{const e=document.querySelectorAll("#article-container .mermaid-wrap");if(e.length){window.runMermaid=()=>{window.loadMermaid=!0;const t="dark"===document.documentElement.getAttribute("data-theme")?"dark":"default";Array.from(e).forEach((e,n)=>{const d=e.firstElementChild,r="mermaid-"+n,i="%%{init:{ 'theme':'"+t+"'}}%%\n"+d.textContent;mermaid.mermaidAPI.render(r,i,e=>{d.insertAdjacentHTML("afterend",e)})})};const t=()=>{window.loadMermaid?runMermaid():getScript("https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js").then(runMermaid)};window.pjax?t():document.addEventListener("DOMContentLoaded",t)}})()</script><script>(()=>{const t=()=>{twikoo.init(Object.assign({el:"#twikoo-wrap",envId:"https://twikoo-five-olive.vercel.app/",region:"",onCommentLoaded:function(){btf.loadLightbox(document.querySelectorAll("#twikoo .tk-content img:not(.vemoji)"))}},null)),GLOBAL_CONFIG_SITE.isPost&&twikoo.getCommentsCount({envId:"https://twikoo-five-olive.vercel.app/",region:"",urls:[window.location.pathname],includeReply:!1}).then((function(t){document.getElementById("twikoo-count").innerText=t[0].count})).catch((function(t){console.error(t)}))},o=()=>{"object"!=typeof twikoo?getScript("https://cdn.jsdelivr.net/npm/twikoo@1.4.15/dist/twikoo.all.min.js").then(t):setTimeout(t,0)};o()})()</script></div><div class="app-refresh" id="app-refresh"><div class="app-refresh-wrap"><label>âœ¨ ç½‘ç«™å·²æ›´æ–°æœ€æ–°ç‰ˆæœ¬ ğŸ‘‰</label> <a href="javascript:void(0)" rel="external nofollow noreferrer" onclick="location.reload()">ç‚¹å‡»åˆ·æ–°</a></div></div><script>function showNotification(){if(GLOBAL_CONFIG.Snackbar){var t="light"===document.documentElement.getAttribute("data-theme")?GLOBAL_CONFIG.Snackbar.bgLight:GLOBAL_CONFIG.Snackbar.bgDark,e=GLOBAL_CONFIG.Snackbar.position;Snackbar.show({text:"å·²æ›´æ–°æœ€æ–°ç‰ˆæœ¬",backgroundColor:t,duration:5e5,pos:e,actionText:"é»æ“Šåˆ·æ–°",actionTextColor:"#fff",onActionClick:function(t){location.reload()}})}else{var o=`top: 0; background: ${"light"===document.documentElement.getAttribute("data-theme")?"#49b1f5":"#1f1f1f"};`;document.getElementById("app-refresh").style.cssText=o}}"serviceWorker"in navigator&&(navigator.serviceWorker.controller&&navigator.serviceWorker.addEventListener("controllerchange",(function(){showNotification()})),window.addEventListener("load",(function(){navigator.serviceWorker.register("/sw.js")})))</script><script defer id="fluttering_ribbon" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful=!0,POWERMODE.shake=!1,POWERMODE.mobile=!1,document.body.addEventListener("input",POWERMODE)</script><script src="//code.tidio.co/xmigmag8yz8wxyxf4rx4tsq9ejzzdqki.js" async></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",tagMode:!1,log:!1,model:{jsonPath:"https://cdn.jsdelivr.net/gh/MCUheart/Hexo-blog-data@1.0.2/live2d-widget-model/haru/01/assets/haru01.model.json"},display:{superSample:2,width:150,height:490,position:"left",hOffset:270,vOffset:-50},mobile:{show:!1,scale:.5},react:{opacityDefault:.7,opacityOnHover:.2}})</script></body></html>